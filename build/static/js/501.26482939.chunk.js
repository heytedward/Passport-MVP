"use strict";(self.webpackChunkmonarch_passport_mvp=self.webpackChunkmonarch_passport_mvp||[]).push([[501],{501:(e,r,n)=>{n.r(r),n.d(r,{default:()=>J});var o,a,t,s,i,l,c,d,u,f,p,g,m=n(2555),h=n(7528),b=n(5043),x=n(3216),w=n(5464),y=n(2507),v=n(342),_=n(6284),j=n(1949),k=n(2768),A=n(579);const C=(0,y.UU)("https://ywagbnjejhpdujkftbxq.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl3YWdibmplamhwZHVqa2Z0YnhxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MjY3NDQsImV4cCI6MjA2NTQwMjc0NH0.veG_QjcIYid1p7R13ERwz9r02VgkkHTOHxW14hnYuBo"),S=w.Ay.div(o||(o=(0,h.A)(["\n  min-height: 100vh;\n  background: linear-gradient(135deg, #000000 0%, #4C1C8C 100%);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding: 20px;\n"]))),I=(0,w.Ay)(j.A)(a||(a=(0,h.A)(["\n  max-width: 450px;\n  width: 100%;\n  text-align: center;\n  padding: 3rem 2.5rem;\n"]))),F=w.Ay.h1(t||(t=(0,h.A)(["\n  font-family: 'Outfit', sans-serif;\n  font-weight: 700;\n  color: #FFB000;\n  font-size: 2.5rem;\n  margin-bottom: 0.5rem;\n"]))),R=w.Ay.p(s||(s=(0,h.A)(["\n  color: rgba(255, 255, 255, 0.7);\n  font-size: 1.1rem;\n  line-height: 1.6;\n  margin-bottom: 2.5rem;\n"]))),z=w.Ay.div(i||(i=(0,h.A)(["\n  display: flex;\n  flex-direction: column;\n  gap: 1.5rem;\n"]))),E=w.Ay.div(l||(l=(0,h.A)(["\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n  text-align: left;\n"]))),U=w.Ay.label(c||(c=(0,h.A)(["\n  color: rgba(255, 255, 255, 0.9);\n  font-size: 0.9rem;\n  font-weight: 500;\n"]))),Y=w.Ay.input(d||(d=(0,h.A)(["\n  padding: 12px 16px;\n  border: 3px solid rgba(255, 215, 0, 0.3);\n  border-radius: 12px;\n  background: rgba(255, 255, 255, 0.05);\n  color: white;\n  font-size: 1rem;\n  transition: all 0.3s ease;\n  box-shadow: \n    0 0 8px 0 rgba(255,215,0,0.1),\n    0 0 16px 0 rgba(255,215,0,0.05),\n    inset 0 1px 0 rgba(255,215,0,0.05);\n  \n  &:focus {\n    outline: none;\n    border: 3px solid #FFD700;\n    background: rgba(255, 255, 255, 0.08);\n    box-shadow: \n      0 0 16px 0 rgba(255,215,0,0.25),\n      0 0 32px 0 rgba(255,215,0,0.12),\n      inset 0 1px 0 rgba(255,215,0,0.15);\n  }\n  \n  &::placeholder {\n    color: rgba(255, 255, 255, 0.4);\n  }\n"]))),P=w.Ay.select(u||(u=(0,h.A)(["\n  padding: 12px 16px;\n  border: 3px solid rgba(255, 215, 0, 0.3);\n  border-radius: 12px;\n  background: rgba(255, 255, 255, 0.05);\n  color: white;\n  font-size: 1rem;\n  transition: all 0.3s ease;\n  box-shadow: \n    0 0 8px 0 rgba(255,215,0,0.1),\n    0 0 16px 0 rgba(255,215,0,0.05),\n    inset 0 1px 0 rgba(255,215,0,0.05);\n  \n  &:focus {\n    outline: none;\n    border: 3px solid #FFD700;\n    background: rgba(255, 255, 255, 0.08);\n    box-shadow: \n      0 0 16px 0 rgba(255,215,0,0.25),\n      0 0 32px 0 rgba(255,215,0,0.12),\n      inset 0 1px 0 rgba(255,215,0,0.15);\n  }\n  \n  option {\n    background: #1a1a1a;\n    color: white;\n  }\n"]))),N=w.Ay.button(f||(f=(0,h.A)(["\n  background: none;\n  border: none;\n  color: #FFB000;\n  font-size: 0.9rem;\n  cursor: pointer;\n  text-decoration: underline;\n  margin-top: 1rem;\n  \n  &:hover {\n    color: #FFC533;\n  }\n"]))),q=w.Ay.div(p||(p=(0,h.A)(["\n  background: rgba(231, 76, 60, 0.1);\n  border: 1px solid rgba(231, 76, 60, 0.3);\n  border-radius: 8px;\n  padding: 12px;\n  color: #e74c3c;\n  font-size: 0.9rem;\n  margin-bottom: 1rem;\n"]))),D=w.Ay.div(g||(g=(0,h.A)(["\n  background: rgba(46, 204, 113, 0.1);\n  border: 1px solid rgba(46, 204, 113, 0.3);\n  border-radius: 8px;\n  padding: 12px;\n  color: #2ecc71;\n  font-size: 0.9rem;\n  margin-bottom: 1rem;\n"]))),J=()=>{const e=(0,x.Zp)(),{user:r,loading:n}=(0,v.A)(),{processReferralSignup:o}=(0,_.K)(),[a,t]=(0,b.useState)(!1),[s,i]=(0,b.useState)(""),[l,c]=(0,b.useState)({email:"",password:"",confirmPassword:"",username:"",clothingSize:""}),[d,u]=(0,b.useState)(""),[f,p]=(0,b.useState)(""),[g,h]=(0,b.useState)(!1);(0,b.useEffect)(()=>{r&&!n&&e("/")},[r,n,e]),(0,b.useEffect)(()=>{const e=window.location.pathname.split("/");if("join"===e[1]&&e[2]){const r=e[2].toUpperCase();i(r),t(!0),p("Welcome! You're joining via referral code: ".concat(r))}},[]);const w=e=>{c((0,m.A)((0,m.A)({},l),{},{[e.target.name]:e.target.value})),u(""),p("")},y=()=>{if(!l.email||!l.password)return u("Email and password are required"),!1;if(a){if(!l.username)return u("Username is required"),!1;if(!l.clothingSize)return u("Please select your clothing size"),!1;if(l.password!==l.confirmPassword)return u("Passwords do not match"),!1;if(l.password.length<6)return u("Password must be at least 6 characters"),!1}return!0};return n?(0,A.jsxs)("div",{style:{minHeight:"100vh",background:"#000000",display:"flex",alignItems:"center",justifyContent:"center",position:"fixed",top:0,left:0,right:0,bottom:0,zIndex:9999},children:[(0,A.jsx)("div",{style:{fontFamily:"Outfit, sans-serif",fontSize:"2.5rem",fontWeight:"700",color:"#FFFFFF",textAlign:"center",textShadow:"0 0 20px rgba(255,255,255,0.8), 0 0 40px rgba(255,255,255,0.4)",animation:"pulse 2s ease-in-out infinite"},children:"Monarch Passport"}),(0,A.jsx)("style",{children:"\n          @keyframes pulse {\n            0%, 100% { opacity: 1; }\n            50% { opacity: 0.7; }\n          }\n        "})]}):(0,A.jsx)(S,{children:(0,A.jsxs)(I,{children:[(0,A.jsx)(F,{children:"Find Your Wings"}),(0,A.jsx)(R,{children:a?"Create your account to start collecting":"Welcome back to your digital passport"}),d&&(0,A.jsx)(q,{children:d}),f&&(0,A.jsx)(D,{children:f}),(0,A.jsx)("form",{onSubmit:r=>{r.preventDefault(),a?(async()=>{if(y()){h(!0),u("");try{const r="https://passport.papillonbrand.us/",{data:n,error:a}=await C.auth.signUp({email:l.email,password:l.password,options:{data:{username:l.username,full_name:l.username,clothing_size:l.clothingSize,referral_code:s||null},emailRedirectTo:"".concat(r,"/auth/callback")}});if(a)throw a;if(s&&n.user){const e=await o(s,n.user.id);e.success?p("Account created! You earned ".concat(e.bonusAmount," WINGS for joining via referral. Check your email to confirm your account.")):p("Account created! Please check your email to confirm your account.")}else n.user&&!n.user.email_confirmed_at?p("Account created! Please check your email to confirm your account."):(p("Account created successfully! Redirecting..."),setTimeout(()=>e("/"),1e3))}catch(d){u(d.message)}finally{h(!1)}}})():(async()=>{if(y()){h(!0),u("");try{const{data:r,error:n}=await C.auth.signInWithPassword({email:l.email,password:l.password});if(n)throw n;p("Login successful! Redirecting..."),setTimeout(()=>e("/"),1e3)}catch(d){u(d.message)}finally{h(!1)}}})()},children:(0,A.jsxs)(z,{children:[a&&(0,A.jsxs)(E,{children:[(0,A.jsx)(U,{children:"Username"}),(0,A.jsx)(Y,{type:"text",name:"username",placeholder:"Enter your username",value:l.username,onChange:w})]}),a&&(0,A.jsxs)(E,{children:[(0,A.jsx)(U,{children:"Referral Code (Optional)"}),(0,A.jsx)(Y,{type:"text",name:"referralCode",placeholder:"Enter referral code",value:s,onChange:e=>i(e.target.value.toUpperCase()),style:{textTransform:"uppercase"}}),s&&(0,A.jsx)("div",{style:{fontSize:"0.8rem",color:"#2ecc71",marginTop:"0.25rem"},children:"\u2713 You'll earn 25 WINGS for joining + 25 more for your first scan!"})]}),a&&(0,A.jsxs)(E,{children:[(0,A.jsx)(U,{children:"Clothing Size"}),(0,A.jsxs)(P,{name:"clothingSize",value:l.clothingSize,onChange:w,children:[(0,A.jsx)("option",{value:"",children:"Select your size"}),(0,A.jsx)("option",{value:"S",children:"S"}),(0,A.jsx)("option",{value:"M",children:"M"}),(0,A.jsx)("option",{value:"L",children:"L"}),(0,A.jsx)("option",{value:"XL",children:"XL"}),(0,A.jsx)("option",{value:"2XL",children:"2XL"}),(0,A.jsx)("option",{value:"3XL",children:"3XL"})]})]}),(0,A.jsxs)(E,{children:[(0,A.jsx)(U,{children:"Email"}),(0,A.jsx)(Y,{type:"email",name:"email",placeholder:"Enter your email",value:l.email,onChange:w})]}),(0,A.jsxs)(E,{children:[(0,A.jsx)(U,{children:"Password"}),(0,A.jsx)(Y,{type:"password",name:"password",placeholder:"Enter your password",value:l.password,onChange:w})]}),a&&(0,A.jsxs)(E,{children:[(0,A.jsx)(U,{children:"Confirm Password"}),(0,A.jsx)(Y,{type:"password",name:"confirmPassword",placeholder:"Confirm your password",value:l.confirmPassword,onChange:w})]}),(0,A.jsx)(k.A,{type:"submit",disabled:g,style:{width:"100%",marginTop:"1rem"},children:g?"Processing...":a?"Create Account":"Sign In"})]})}),(0,A.jsx)(N,{onClick:()=>t(!a),children:a?"Already have an account? Sign in":"Don't have an account? Sign up"})]})})}},1949:(e,r,n)=>{n.d(r,{A:()=>l});var o,a,t=n(7528),s=n(5464);const i=(0,s.i7)(o||(o=(0,t.A)(["\n  0%, 100% { \n    box-shadow: \n      0 0 12px 0 rgba(255,215,0,0.15),\n      0 0 24px 0 rgba(255,215,0,0.08),\n      inset 0 1px 0 rgba(255,215,0,0.1);\n  }\n  50% { \n    box-shadow: \n      0 0 20px 0 rgba(255,215,0,0.3),\n      0 0 40px 0 rgba(255,215,0,0.15),\n      inset 0 1px 0 rgba(255,215,0,0.2);\n  }\n"]))),l=s.Ay.div(a||(a=(0,t.A)(["\n  position: relative;\n  background: ",";\n  border-radius: 20px;\n  border: 3px solid ",";\n  box-shadow: \n    0 0 12px 0 rgba(255,215,0,0.15),\n    0 0 24px 0 rgba(255,215,0,0.08),\n    inset 0 1px 0 rgba(255,215,0,0.1);\n  backdrop-filter: blur(18px);\n  -webkit-backdrop-filter: blur(18px);\n  overflow: hidden;\n  transition: transform 0.18s cubic-bezier(0.4,0,0.2,1), box-shadow 0.18s, border 0.18s;\n  \n  &:hover {\n    transform: translateY(-3px) scale(1.02);\n    border: 3px solid ",";\n    box-shadow: \n      0 0 20px 0 rgba(255,215,0,0.3),\n      0 0 40px 0 rgba(255,215,0,0.15),\n      inset 0 1px 0 rgba(255,215,0,0.2);\n    animation: "," 2s ease-in-out infinite;\n  }\n  \n  /* Content positioning */\n  > * {\n    position: relative;\n    z-index: 1;\n  }\n"])),e=>{var r,n;let{theme:o}=e;return(null===(r=o.colors)||void 0===r||null===(n=r.glass)||void 0===n?void 0:n.background)||"linear-gradient(135deg, rgba(20,20,20,0.95) 0%, rgba(30,30,30,0.90) 50%, rgba(15,15,15,0.98) 100%)"},e=>{var r,n;let{theme:o}=e;return(null===(r=o.colors)||void 0===r||null===(n=r.accent)||void 0===n?void 0:n.gold)||"#FFD700"},e=>{var r,n;let{theme:o}=e;return(null===(r=o.colors)||void 0===r||null===(n=r.accent)||void 0===n?void 0:n.gold)||"#FFD700"},i)},2768:(e,r,n)=>{n.d(r,{A:()=>i});var o,a,t=n(7528),s=(n(5043),n(5464));(0,s.i7)(o||(o=(0,t.A)(["\n  0%, 100% { box-shadow: 0 0 5px #FFB000, 0 0 10px #FFB000, 0 0 15px #FFB000; }\n  50% { box-shadow: 0 0 10px #FFB000, 0 0 20px #FFB000, 0 0 30px #FFB000; }\n"])));const i=s.Ay.button(a||(a=(0,t.A)(["\n  background: ",";\n  color: ",";\n  border: 3px solid ",";\n  border-radius: 20px;\n  font-family: ",";\n  font-size: ",";\n  font-weight: ",";\n  padding: 16px 32px;\n  cursor: pointer;\n  transition: all "," ",";\n  \n  &:hover {\n    transform: translateY(-3px) scale(1.02);\n    background: transparent;\n    color: ",";\n    box-shadow: ",";\n  }\n  &:focus {\n    outline: none;\n    transform: translateY(-3px) scale(1.02);\n    background: transparent;\n    color: ",";\n    box-shadow: ",";\n  }\n  &:active {\n    transform: translateY(-1px) scale(1.01);\n  }\n"])),e=>{let{theme:r}=e;return r.colors.accent.gold},e=>{let{theme:r}=e;return r.colors.background},e=>{let{theme:r}=e;return r.colors.accent.gold},e=>{let{theme:r}=e;return r.typography.fontFamily.heading},e=>{let{theme:r}=e;return r.typography.fontSize.body},e=>{let{theme:r}=e;return r.typography.fontWeight.bold},e=>{let{theme:r}=e;return r.animation.duration.normal},e=>{let{theme:r}=e;return r.animation.timing.smooth},e=>{let{theme:r}=e;return r.colors.accent.gold},e=>{let{theme:r}=e;return r.effects.neonGlow},e=>{let{theme:r}=e;return r.colors.accent.gold},e=>{let{theme:r}=e;return r.effects.neonGlow})},6284:(e,r,n)=>{n.d(r,{K:()=>i});var o=n(5043),a=n(2507),t=n(342);const s=(0,a.UU)("https://ywagbnjejhpdujkftbxq.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl3YWdibmplamhwZHVqa2Z0YnhxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MjY3NDQsImV4cCI6MjA2NTQwMjc0NH0.veG_QjcIYid1p7R13ERwz9r02VgkkHTOHxW14hnYuBo"),i=()=>{const{user:e}=(0,t.A)(),[r,n]=(0,o.useState)(null),[a,i]=(0,o.useState)({totalReferrals:0,pendingReferrals:0,completedReferrals:0,totalWingsEarned:0}),[l,c]=(0,o.useState)([]),[d,u]=(0,o.useState)(!0),[f,p]=(0,o.useState)(!0),[g,m]=(0,o.useState)(null),h=(0,o.useRef)(!1),b=(0,o.useRef)(!1),x=(0,o.useRef)(null),w=(0,o.useRef)(null),y=((0,o.useCallback)(e=>{var r,n;if(!e)return null;const o=((null===(r=e.user_metadata)||void 0===r?void 0:r.username)||(null===(n=e.email)||void 0===n?void 0:n.split("@")[0])||"user").toLowerCase().replace(/[^a-z0-9]/g,"").substring(0,6),a=Math.random().toString(36).substring(2,5);return"".concat(o).concat(a).toUpperCase()},[]),(0,o.useCallback)(async()=>{if(e){p(!0);try{console.log("\ud83d\udd17 Ensuring referral code for user:",e.id);const a=localStorage.getItem("referral_".concat(e.id));if(a)try{const e=JSON.parse(a);if(Date.now()-e.timestamp<18e5)return console.log("\ud83d\udd17 Using cached referral code:",e.code),n(e.code),void p(!1)}catch(r){console.log("\ud83d\udd17 Cache parse error, proceeding with fresh generation")}let t,i=null,l=null;try{const r=new Promise((e,r)=>setTimeout(()=>r(new Error("Referral code generation timeout")),3e3)),n=s.from("user_profiles").select("referral_code").eq("id",e.id).single(),{data:o,error:a}=await Promise.race([n,r]);!a&&null!==o&&void 0!==o&&o.referral_code?(i=o.referral_code,console.log("\ud83d\udd17 Database query successful, found code:",i)):(l=a,console.log("\ud83d\udd17 Database query failed or no code found:",a))}catch(o){console.log("\ud83d\udd17 Database query timed out, using fallback"),l=o}i?(t=i,console.log("\ud83d\udd17 Using database code:",t)):(console.log("\ud83d\udd17 Generating fallback referral code"),t=v(),console.log("\ud83d\udd17 Generated fallback code:",t)),localStorage.setItem("referral_".concat(e.id),JSON.stringify({code:t,timestamp:Date.now()})),n(t),p(!1)}catch(g){console.error("\ud83d\udd17 Critical error ensuring referral code:",g);const o=v();console.log("\ud83d\udd17 Using last resort fallback code:",o),localStorage.setItem("referral_".concat(e.id),JSON.stringify({code:o,timestamp:Date.now()})),n(o),p(!1)}}},[e])),v=()=>{const e=Date.now().toString(36),r=Math.random().toString(36).substring(2,8);return"MONARCH".concat(e).concat(r).toUpperCase()},_=(0,o.useCallback)(async()=>{if(e)try{u(!0);const{data:r,error:n}=await s.from("referrals").select("status, created_at, referrer_reward_given, referrer_wings_earned").eq("referrer_id",e.id);if(n)throw n;const{data:o,error:a}=await s.from("user_profiles").select("total_referrals, referral_wings_earned").eq("id",e.id).single();if(a&&"PGRST116"!==a.code)throw a;const t={totalReferrals:(null===r||void 0===r?void 0:r.length)||0,pendingReferrals:(null===r||void 0===r?void 0:r.filter(e=>"pending"===e.status).length)||0,completedReferrals:(null===r||void 0===r?void 0:r.filter(e=>"completed"===e.status).length)||0,totalWingsEarned:(null===o||void 0===o?void 0:o.referral_wings_earned)||0};i(t)}catch(g){console.error("Error loading referral stats:",g),m(g.message)}finally{u(!1)}},[e]),j=(0,o.useCallback)(async()=>{if(e)try{const{data:r,error:n}=await s.from("referrals").select("\n          *,\n          referee:referee_id (\n            email,\n            user_metadata\n          )\n        ").eq("referrer_id",e.id).order("created_at",{ascending:!1});if(n)throw n;const o=(null===r||void 0===r?void 0:r.map(e=>{var r,n,o,a,t;return{id:e.id,refereeName:(null===(r=e.referee)||void 0===r||null===(n=r.user_metadata)||void 0===n?void 0:n.username)||(null===(o=e.referee)||void 0===o||null===(a=o.email)||void 0===a?void 0:a.split("@")[0])||"User",refereeEmail:null===(t=e.referee)||void 0===t?void 0:t.email,status:e.status,createdAt:e.created_at,completedAt:e.completed_at,rewardGiven:e.referrer_reward_given,wingsEarned:e.referrer_wings_earned||0}}))||[];c(o)}catch(g){console.error("Error loading referral history:",g),m(g.message)}},[e]),k=(0,o.useCallback)(async(e,r)=>{if(e&&r)try{console.log("\ud83d\udd04 Processing referral signup:",{referralCode:e,newUserId:r});const{data:n,error:o}=await s.from("referral_codes").select("user_id").eq("referral_code",e.toUpperCase()).eq("is_active",!0).single();if(o||!n)return console.warn("Invalid referral code:",e),{success:!1,error:"Invalid referral code"};if(n.user_id===r)return console.warn("Self-referral attempt blocked"),{success:!1,error:"Cannot refer yourself"};let a=25;const{data:t,error:i}=await s.from("referrals").insert([{referrer_id:n.user_id,referee_id:r,referral_code:e.toUpperCase(),status:"pending",referee_wings_earned:a}]).select().single();if(i)throw i;const{error:l}=await s.rpc("add_wings_to_user",{user_id_param:r,wings_amount:a,activity_type_param:"referral_bonus",description_param:"Welcome bonus for joining via referral code: ".concat(e)});return l&&console.warn("Failed to award welcome bonus:",l),console.log("\u2705 Referral signup processed successfully"),{success:!0,data:t,bonusAmount:a}}catch(g){return console.error("Error processing referral signup:",g),{success:!1,error:g.message}}},[]),A=(0,o.useCallback)(async e=>{try{console.log("\ud83d\udd04 Attempting to complete referral for referee:",e);const{data:r,error:n}=await s.from("referrals").select("*").eq("referee_id",e).eq("status","pending").single();if(n||!r)return console.log("No pending referral found for referee:",e),{success:!1,message:"No pending referral found"};let o=50,a=25;const{error:t}=await s.from("referrals").update({status:"completed",completed_at:(new Date).toISOString(),referrer_reward_given:!0,referee_reward_given:!0,referrer_wings_earned:o,referee_wings_earned:(r.referee_wings_earned||0)+a}).eq("id",r.id);if(t)throw t;return await Promise.all([s.rpc("add_wings_to_user",{user_id_param:r.referrer_id,wings_amount:o,activity_type_param:"referral",description_param:"Referral completed - friend completed first scan"}),s.rpc("add_wings_to_user",{user_id_param:e,wings_amount:a,activity_type_param:"referral_bonus",description_param:"First scan bonus - referred user reward"})]),await s.from("user_profiles").update({total_referrals:s.raw("COALESCE(total_referrals, 0) + 1")}).eq("id",r.referrer_id),console.log("\u2705 Referral completed successfully"),{success:!0,referrerReward:o,refereeReward:a}}catch(g){return console.error("Error completing referral:",g),{success:!1,error:g.message}}},[]),C=(0,o.useCallback)(e=>{if(!e)return"";const r=window.location.origin;return"".concat(r,"/join/").concat(e)},[]),S=(0,o.useCallback)(async e=>{const r=C(e);let n="Join me on Monarch Passport! \ud83e\udd8b\n\nEarn exclusive fashion rewards by scanning QR codes. Use my code: ".concat(e);if(navigator.share)try{return await navigator.share({title:"Join Monarch Passport",text:n,url:r}),{success:!0}}catch(g){"AbortError"!==g.name&&console.log("Share failed:",g)}try{return await navigator.clipboard.writeText("".concat(n,"\n\n").concat(r)),{success:!0,copied:!0}}catch(g){return console.error("Failed to copy to clipboard:",g),{success:!1,link:r}}},[C]);return(0,o.useEffect)(()=>{console.log("\ud83d\udd27 useReferrals useEffect triggered, user:",null===e||void 0===e?void 0:e.id),(null===e||void 0===e?void 0:e.id)!==x.current?(x.current=null===e||void 0===e?void 0:e.id,e?(console.log("\u2705 User found, calling ensureReferralCode..."),y(),_(),j()):(console.log("\u274c No user found, resetting referral state"),n(null),i({totalReferrals:0,pendingReferrals:0,completedReferrals:0,totalWingsEarned:0}),c([]),u(!1),p(!1),h.current=!1,b.current=!1)):console.log("\ud83d\udd04 Same user, skipping initialization")},[e,y]),(0,o.useEffect)(()=>()=>{w.current&&clearTimeout(w.current)},[]),{referralCode:r,referralStats:a,referralHistory:l,loading:d,referralLoading:f,setReferralLoading:p,error:g,processReferralSignup:k,completeReferral:A,generateReferralLink:C,shareReferral:S,refreshData:()=>{_(),j()}}}}}]);
//# sourceMappingURL=501.26482939.chunk.js.map