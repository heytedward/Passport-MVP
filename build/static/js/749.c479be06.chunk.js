"use strict";(self.webpackChunkmonarch_passport_mvp=self.webpackChunkmonarch_passport_mvp||[]).push([[749],{1949:(e,s,t)=>{t.d(s,{A:()=>c});var r,i,a=t(7528),n=t(5464);const o=(0,n.i7)(r||(r=(0,a.A)(["\n  0%, 100% { \n    box-shadow: \n      0 0 12px 0 rgba(255,215,0,0.15),\n      0 0 24px 0 rgba(255,215,0,0.08),\n      inset 0 1px 0 rgba(255,215,0,0.1);\n  }\n  50% { \n    box-shadow: \n      0 0 20px 0 rgba(255,215,0,0.3),\n      0 0 40px 0 rgba(255,215,0,0.15),\n      inset 0 1px 0 rgba(255,215,0,0.2);\n  }\n"]))),c=n.Ay.div(i||(i=(0,a.A)(["\n  position: relative;\n  background: ",";\n  border-radius: 20px;\n  border: 3px solid ",";\n  box-shadow: \n    0 0 12px 0 rgba(255,215,0,0.15),\n    0 0 24px 0 rgba(255,215,0,0.08),\n    inset 0 1px 0 rgba(255,215,0,0.1);\n  backdrop-filter: blur(18px);\n  -webkit-backdrop-filter: blur(18px);\n  overflow: hidden;\n  transition: transform 0.18s cubic-bezier(0.4,0,0.2,1), box-shadow 0.18s, border 0.18s;\n  \n  &:hover {\n    transform: translateY(-3px) scale(1.02);\n    border: 3px solid ",";\n    box-shadow: \n      0 0 20px 0 rgba(255,215,0,0.3),\n      0 0 40px 0 rgba(255,215,0,0.15),\n      inset 0 1px 0 rgba(255,215,0,0.2);\n    animation: "," 2s ease-in-out infinite;\n  }\n  \n  /* Content positioning */\n  > * {\n    position: relative;\n    z-index: 1;\n  }\n"])),e=>{var s,t;let{theme:r}=e;return(null===(s=r.colors)||void 0===s||null===(t=s.glass)||void 0===t?void 0:t.background)||"linear-gradient(135deg, rgba(20,20,20,0.95) 0%, rgba(30,30,30,0.90) 50%, rgba(15,15,15,0.98) 100%)"},e=>{var s,t;let{theme:r}=e;return(null===(s=r.colors)||void 0===s||null===(t=s.accent)||void 0===t?void 0:t.gold)||"#FFD700"},e=>{var s,t;let{theme:r}=e;return(null===(s=r.colors)||void 0===s||null===(t=s.accent)||void 0===t?void 0:t.gold)||"#FFD700"},o)},2768:(e,s,t)=>{t.d(s,{A:()=>o});var r,i,a=t(7528),n=(t(5043),t(5464));(0,n.i7)(r||(r=(0,a.A)(["\n  0%, 100% { box-shadow: 0 0 5px #FFB000, 0 0 10px #FFB000, 0 0 15px #FFB000; }\n  50% { box-shadow: 0 0 10px #FFB000, 0 0 20px #FFB000, 0 0 30px #FFB000; }\n"])));const o=n.Ay.button(i||(i=(0,a.A)(["\n  background: ",";\n  color: ",";\n  border: 3px solid ",";\n  border-radius: 20px;\n  font-family: ",";\n  font-size: ",";\n  font-weight: ",";\n  padding: 16px 32px;\n  cursor: pointer;\n  transition: all "," ",";\n  \n  &:hover {\n    transform: translateY(-3px) scale(1.02);\n    background: transparent;\n    color: ",";\n    box-shadow: ",";\n  }\n  &:focus {\n    outline: none;\n    transform: translateY(-3px) scale(1.02);\n    background: transparent;\n    color: ",";\n    box-shadow: ",";\n  }\n  &:active {\n    transform: translateY(-1px) scale(1.01);\n  }\n"])),e=>{let{theme:s}=e;return s.colors.accent.gold},e=>{let{theme:s}=e;return s.colors.background},e=>{let{theme:s}=e;return s.colors.accent.gold},e=>{let{theme:s}=e;return s.typography.fontFamily.heading},e=>{let{theme:s}=e;return s.typography.fontSize.body},e=>{let{theme:s}=e;return s.typography.fontWeight.bold},e=>{let{theme:s}=e;return s.animation.duration.normal},e=>{let{theme:s}=e;return s.animation.timing.smooth},e=>{let{theme:s}=e;return s.colors.accent.gold},e=>{let{theme:s}=e;return s.effects.neonGlow},e=>{let{theme:s}=e;return s.colors.accent.gold},e=>{let{theme:s}=e;return s.effects.neonGlow})},4986:(e,s,t)=>{t.d(s,{Fg:()=>Ae});var r,i=t(2555);const a={SUPABASE_URL:"https://ywagbnjejhpdujkftbxq.supabase.co",SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl3YWdibmplamhwZHVqa2Z0YnhxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MjY3NDQsImV4cCI6MjA2NTQwMjc0NH0.veG_QjcIYid1p7R13ERwz9r02VgkkHTOHxW14hnYuBo"},n={DEBUG_MODE:!1,BETA_FEATURES:!1,RATE_LIMIT_SCANS:parseInt("10")||10,RATE_LIMIT_LOGINS:parseInt("5")||5,SESSION_TIMEOUT:parseInt("60")||3600,MAX_FILE_SIZE:parseInt("5242880")||5242880,ALLOWED_FILE_TYPES:(null===(r="image/jpeg,image/png,image/webp")?void 0:r.split(","))||["image/jpeg","image/png","image/webp"]};const o=new class{constructor(){this.config={},this.initialize()}initialize(){try{!function(){const e=[];if(Object.entries(a).forEach(s=>{let[t,r]=s;r||e.push(t)}),e.length>0)throw new Error("Missing required configuration: ".concat(e.join(", ")))}(),this.config=(0,i.A)((0,i.A)({},a),n),console.log("\ud83d\udd12 Secure configuration initialized successfully")}catch(e){throw console.error("\u274c Configuration validation failed:",e.message),e}}get(e){return this.config[e]}getClientConfig(){return{SUPABASE_URL:this.config.SUPABASE_URL,SUPABASE_ANON_KEY:this.config.SUPABASE_ANON_KEY,DEBUG_MODE:this.config.DEBUG_MODE,BETA_FEATURES:this.config.BETA_FEATURES,RATE_LIMIT_SCANS:this.config.RATE_LIMIT_SCANS,RATE_LIMIT_LOGINS:this.config.RATE_LIMIT_LOGINS,SESSION_TIMEOUT:this.config.SESSION_TIMEOUT,MAX_FILE_SIZE:this.config.MAX_FILE_SIZE,ALLOWED_FILE_TYPES:this.config.ALLOWED_FILE_TYPES}}audit(){const e={timestamp:(new Date).toISOString(),environment:"production",requiredVars:Object.keys(a).length,optionalVars:Object.keys(n).length,missingVars:[],warnings:[]};return Object.entries(a).forEach(s=>{let[t,r]=s;r||e.missingVars.push(t)}),this.config.DEBUG_MODE&&e.warnings.push("DEBUG_MODE should not be enabled in production"),e}},c={USER_ID:/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i,EMAIL:/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/,USERNAME:/^[a-zA-Z0-9_-]{3,20}$/,DISPLAY_NAME:/^[a-zA-Z0-9\s\-_\.]{2,50}$/,REWARD_ID:/^[a-zA-Z0-9_-]+$/,QR_DATA:/^data:application\/json;base64,[A-Za-z0-9+/]*={0,2}$/,IMAGE_EXTENSION:/\.(jpg|jpeg|png|webp|gif)$/i,IMAGE_MIME:/^image\/(jpeg|png|webp|gif)$/i,URL:/^https?:\/\/[^\s/$.?#].[^\s]*$/i,PHONE:/^\+?[\d\s\-\(\)]{10,15}$/,DATE:/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{3})?Z?$/,TIMESTAMP:/^\d{10,13}$/},_={SQL_INJECTION:[/(\b(union|select|insert|update|delete|drop|create|alter)\b)/i,/(\b(or|and)\b\s+\d+\s*=\s*\d+)/i,/(\b(union|select|insert|update|delete|drop|create|alter)\b.*\b(union|select|insert|update|delete|drop|create|alter)\b)/i,/(\b(exec|execute|sp_|xp_)\b)/i,/(\b(script|javascript|vbscript|expression)\b)/i],XSS:[/<script[^>]*>/i,/javascript:/i,/on\w+\s*=/i,/<iframe[^>]*>/i,/<object[^>]*>/i,/<embed[^>]*>/i,/<link[^>]*>/i,/<meta[^>]*>/i,/<style[^>]*>/i,/<form[^>]*>/i,/<input[^>]*>/i,/<textarea[^>]*>/i,/<select[^>]*>/i,/<button[^>]*>/i,/<a[^>]*>/i,/<img[^>]*>/i,/<video[^>]*>/i,/<audio[^>]*>/i,/<canvas[^>]*>/i,/<svg[^>]*>/i],PATH_TRAVERSAL:[/\.\.\//,/\.\.\\/,/%2e%2e%2f/i,/%2e%2e%5c/i,/\.\.%2f/i,/\.\.%5c/i],COMMAND_INJECTION:[/(\b(cat|ls|pwd|whoami|id|uname|ps|netstat|ifconfig|ipconfig)\b)/i,/(\b(rm|del|erase|format|fdisk|mkfs)\b)/i,/(\b(wget|curl|nc|telnet|ssh|ftp)\b)/i,/(\b(ping|traceroute|nslookup|dig)\b)/i,/(\b(sudo|su|chmod|chown)\b)/i],NOSQL_INJECTION:[/(\$where|\$ne|\$gt|\$lt|\$gte|\$lte|\$in|\$nin|\$exists|\$regex)/i,/(\$or|\$and|\$not|\$nor)/i,/(\$set|\$unset|\$inc|\$push|\$pull)/i]},E=new Map;function A(e,s){const t="".concat(e,":").concat(s),r=Date.now();E.has(t)||E.set(t,[]);const i=E.get(t).filter(e=>r-e<6e4);if(i.length>=100)throw new Error("Input rate limit exceeded for ".concat(s,". Please wait before trying again."));return i.push(r),E.set(t,i),!0}function l(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;if("string"!==typeof e)throw new Error("Input must be a string");if(e.length>s)throw new Error("Input too long. Maximum length is ".concat(s," characters."));let t=e.replace(/\0/g,"");return t=t.trim(),Object.entries(_).forEach(e=>{let[s,r]=e;r.forEach(e=>{if(e.test(t))throw new Error("Malicious input detected: ".concat(s))})}),t}function d(e){try{const s=l(e,36);if(!c.USER_ID.test(s))throw new Error("Invalid user ID format");return{success:!0,data:s,message:"User ID validated successfully"}}catch(s){return{success:!1,error:s.message,message:"User ID validation failed"}}}function u(e){try{const s=l(e,254);if(!c.EMAIL.test(s))throw new Error("Invalid email format");const[t,r]=s.split("@");if(t.length>64||r.length>253)throw new Error("Email address too long");if(0===t.length||0===r.length)throw new Error("Invalid email structure");return{success:!0,data:s.toLowerCase(),message:"Email validated successfully"}}catch(s){return{success:!1,error:s.message,message:"Email validation failed"}}}function P(e){try{const s=l(e,20);if(!c.USERNAME.test(s))throw new Error("Username must be 3-20 characters, alphanumeric with hyphens and underscores only");if(["admin","root","system","support","help","info","test","demo"].includes(s.toLowerCase()))throw new Error("Username is reserved");return{success:!0,data:s,message:"Username validated successfully"}}catch(s){return{success:!1,error:s.message,message:"Username validation failed"}}}function T(e){try{const s=l(e,50);if(!c.DISPLAY_NAME.test(s))throw new Error("Display name must be 2-50 characters, letters, numbers, spaces, hyphens, underscores, and periods only");return{success:!0,data:s,message:"Display name validated successfully"}}catch(s){return{success:!1,error:s.message,message:"Display name validation failed"}}}function I(e,s){try{A(s,"qr_scan");const r=l(e,1e4);if(c.QR_DATA.test(r))return{success:!0,data:r,type:"data_url",message:"QR data URL validated successfully"};try{const e=JSON.parse(r);if("object"===typeof e&&null!==e)return{success:!0,data:r,type:"json",message:"QR JSON data validated successfully"}}catch(t){}if(r.length>0&&r.length<=1e3)return{success:!0,data:r,type:"string",message:"QR string data validated successfully"};throw new Error("Invalid QR data format")}catch(r){return{success:!1,error:r.message,message:"QR data validation failed"}}}function S(e,s){try{if(A(s,"file_upload"),!e)throw new Error("No file provided");const t=o.get("MAX_FILE_SIZE");if(e.size>t)throw new Error("File too large. Maximum size is ".concat(Math.round(t/1024/1024),"MB"));const r=o.get("ALLOWED_FILE_TYPES");if(!r.includes(e.type))throw new Error("File type not allowed. Allowed types: ".concat(r.join(", ")));const i=e.name||"";if(!c.IMAGE_EXTENSION.test(i))throw new Error("File extension not allowed. Only image files are permitted");const a=l(i,255);if(_.PATH_TRAVERSAL.some(e=>e.test(a)))throw new Error("Malicious filename detected");return{success:!0,data:{file:e,fileName:a,fileSize:e.size,fileType:e.type},message:"File upload validated successfully"}}catch(t){return{success:!1,error:t.message,message:"File upload validation failed"}}}function R(e){try{const s=l(e,20);if(!c.PHONE.test(s))throw new Error("Invalid phone number format");const t=s.replace(/\D/g,"");if(t.length<10||t.length>15)throw new Error("Phone number must be 10-15 digits");return{success:!0,data:s,message:"Phone number validated successfully"}}catch(s){return{success:!1,error:s.message,message:"Phone number validation failed"}}}function p(e,s){try{A(s,"profile_update");const t={},r=[];if(e.email){const s=u(e.email);s.success?t.email=s.data:r.push("Email: ".concat(s.error))}if(e.username){const s=P(e.username);s.success?t.username=s.data:r.push("Username: ".concat(s.error))}if(e.display_name){const s=T(e.display_name);s.success?t.display_name=s.data:r.push("Display name: ".concat(s.error))}if(e.phone){const s=R(e.phone);s.success?t.phone=s.data:r.push("Phone: ".concat(s.error))}if(e.bio){const s=l(e.bio,500);t.bio=s}if(r.length>0)throw new Error("Validation errors: ".concat(r.join("; ")));return{success:!0,data:t,message:"User profile validated successfully"}}catch(t){return{success:!1,error:t.message,message:"User profile validation failed"}}}function m(){return{timestamp:(new Date).toISOString(),rateLimits:E.size,activeUsers:new Set([...E.keys()].map(e=>e.split(":")[0])).size,validationPatterns:Object.keys(c).length,maliciousPatterns:Object.keys(_).length}}const h={USER:"user",MODERATOR:"moderator",ADMIN:"admin",SUPER_ADMIN:"super_admin"},g={USER:{VIEW_OWN_PROFILE:"user:profile:view",EDIT_OWN_PROFILE:"user:profile:edit",SCAN_QR:"user:qr:scan",VIEW_OWN_REWARDS:"user:rewards:view",VIEW_OWN_STAMPS:"user:stamps:view",UPLOAD_AVATAR:"user:avatar:upload",VIEW_OWN_ACTIVITY:"user:activity:view"},MODERATOR:{VIEW_ALL_PROFILES:"moderator:profiles:view",MODERATE_CONTENT:"moderator:content:moderate",VIEW_REPORTS:"moderator:reports:view",MANAGE_REWARDS:"moderator:rewards:manage",VIEW_ANALYTICS:"moderator:analytics:view"},ADMIN:{MANAGE_USERS:"admin:users:manage",MANAGE_ROLES:"admin:roles:manage",VIEW_ALL_DATA:"admin:data:view",MANAGE_SYSTEM:"admin:system:manage",VIEW_SECURITY_LOGS:"admin:security:view",MANAGE_REWARDS:"admin:rewards:manage",MANAGE_CONTENT:"admin:content:manage",VIEW_ADMIN_PANEL:"admin:panel:view"},SUPER_ADMIN:{ALL_PERMISSIONS:"super_admin:all",MANAGE_ADMINS:"super_admin:admins:manage",SYSTEM_CONFIG:"super_admin:config:manage",SECURITY_AUDIT:"super_admin:security:audit",DATA_EXPORT:"super_admin:data:export"}},C={[h.USER]:[],[h.MODERATOR]:[h.USER],[h.ADMIN]:[h.MODERATOR,h.USER],[h.SUPER_ADMIN]:[h.ADMIN,h.MODERATOR,h.USER]},f={"/":[],"/login":[],"/register":[],"/forgot-password":[],"/home":[g.USER.VIEW_OWN_PROFILE],"/passport":[g.USER.VIEW_OWN_STAMPS],"/closet":[g.USER.VIEW_OWN_REWARDS],"/profile":[g.USER.VIEW_OWN_PROFILE],"/scan":[g.USER.SCAN_QR],"/settings":[g.USER.EDIT_OWN_PROFILE],"/moderator":[g.MODERATOR.VIEW_REPORTS],"/moderator/profiles":[g.MODERATOR.VIEW_ALL_PROFILES],"/moderator/content":[g.MODERATOR.MODERATE_CONTENT],"/moderator/analytics":[g.MODERATOR.VIEW_ANALYTICS],"/admin":[g.ADMIN.VIEW_ADMIN_PANEL],"/admin/users":[g.ADMIN.MANAGE_USERS],"/admin/roles":[g.ADMIN.MANAGE_ROLES],"/admin/security":[g.ADMIN.VIEW_SECURITY_LOGS],"/admin/system":[g.ADMIN.MANAGE_SYSTEM],"/admin/rewards":[g.ADMIN.MANAGE_REWARDS],"/admin/content":[g.ADMIN.MANAGE_CONTENT],"/super-admin":[g.SUPER_ADMIN.ALL_PERMISSIONS],"/super-admin/admins":[g.SUPER_ADMIN.MANAGE_ADMINS],"/super-admin/config":[g.SUPER_ADMIN.SYSTEM_CONFIG],"/super-admin/audit":[g.SUPER_ADMIN.SECURITY_AUDIT],"/super-admin/export":[g.SUPER_ADMIN.DATA_EXPORT]},O=new Map,N=[];function L(e,s){try{const t=d(e);if(!t.success)throw new Error("Invalid user ID: ".concat(t.error));const r=y(e);if(!r)return!1;const i=function(e){if(!h[e.toUpperCase()])throw new Error("Invalid role: ".concat(e));const s=new Set;return g[e.toUpperCase()]&&Object.values(g[e.toUpperCase()]).forEach(e=>{s.add(e)}),(C[e]||[]).forEach(e=>{g[e.toUpperCase()]&&Object.values(g[e.toUpperCase()]).forEach(e=>{s.add(e)})}),Array.from(s)}(r),a=i.includes(s)||i.includes(g.SUPER_ADMIN.ALL_PERMISSIONS);return v(e,s,a),a}catch(t){return console.error("Permission check failed:",t.message),v(e,s,!1,t.message),!1}}function D(e,s){return Array.isArray(s)||(s=[s]),s.some(s=>L(e,s))}function M(e,s){try{if(f[s]&&0===f[s].length)return!0;const t=f[s];return!t||0===t.length||D(e,t)}catch(t){return console.error("Route access check failed:",t.message),!1}}function y(e){if(O.has(e))return O.get(e);const s={}[e]||h.USER;return O.set(e,s),s}function b(e){try{if(!Object.values(h).includes(e))throw new Error("Invalid role: ".concat(e));const s=[];for(const[t,r]of O.entries())r===e&&s.push(t);return{success:!0,data:s,message:"Found ".concat(s.length," users with role ").concat(e)}}catch(s){return{success:!1,error:s.message,message:"Failed to get users by role"}}}function w(e){const s=y(e);return s===h.ADMIN||s===h.SUPER_ADMIN}function U(e){return y(e)===h.SUPER_ADMIN}function v(e,s,t){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const i={timestamp:(new Date).toISOString(),userId:e,permission:s,granted:t,error:r,ip:"client-ip",userAgent:"client-user-agent"};N.push(i),N.length>1e3&&N.splice(0,N.length-1e3),o.get("DEBUG_MODE")&&console.log("\ud83d\udd10 Access Log: ".concat(t?"\u2705":"\u274c"," ").concat(e," -> ").concat(s))}function Y(){return{timestamp:(new Date).toISOString(),totalUsers:O.size,roles:Object.values(h).reduce((e,s)=>(e[s]=b(s).data.length,e),{}),accessLogEntries:N.length,permissions:Object.keys(g).length,routes:Object.keys(f).length}}const F=new Map,k={QR_SCAN:{window:6e4,limit:o.get("RATE_LIMIT_SCANS")||10,key:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://ywagbnjejhpdujkftbxq.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl3YWdibmplamhwZHVqa2Z0YnhxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MjY3NDQsImV4cCI6MjA2NTQwMjc0NH0.veG_QjcIYid1p7R13ERwz9r02VgkkHTOHxW14hnYuBo",REACT_APP_SUPABASE_SERVICE_ROLE_KEY:"your-supabase-service-role-key-here",REACT_APP_SECRET_KEY:"PapillonLabs_Monarch_c3a4196059e92e4af0753274e01fa917",REACT_APP_ENCRYPTION_KEY:"PapillonLabs_Nectar_dCK2ThywLPW0wHkNbejY9xXsxs",REACT_APP_JWT_SECRET:"PapillonLabs_Wing_ba948293ebe41b1523f9f7de32f90cc8d53a7e68",REACT_APP_BETA_PASSWORD:"papillon2025",REACT_APP_NAME:"Monarch Passport MVP",REACT_APP_VERSION:"0.1.0",REACT_APP_DEFAULT_THEME_MODE:"dark",REACT_APP_DEFAULT_GRADIENT:"monarch",REACT_APP_DEFAULT_THEME:"frequencyPulse",REACT_APP_BASE_URL:"https://passport.papillonbrand.us/",REACT_APP_BETA_FEATURES_ENABLED:"false",REACT_APP_DEBUG_MODE:"false",REACT_APP_RATE_LIMIT_SCANS:"10",REACT_APP_RATE_LIMIT_LOGINS:"5",REACT_APP_SESSION_TIMEOUT:"60",REACT_APP_MAX_FILE_SIZE:"5242880",REACT_APP_ALLOWED_FILE_TYPES:"image/jpeg,image/png,image/webp",REACT_APP_ANALYTICS_ID:"your-analytics-id-here",REACT_APP_SENTRY_DSN:"your-sentry-dsn-here"}.REACT_APP_RATE_LIMIT_QR_KEY||"qr_scan"},LOGIN:{window:9e5,limit:o.get("RATE_LIMIT_LOGINS")||5,key:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://ywagbnjejhpdujkftbxq.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl3YWdibmplamhwZHVqa2Z0YnhxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MjY3NDQsImV4cCI6MjA2NTQwMjc0NH0.veG_QjcIYid1p7R13ERwz9r02VgkkHTOHxW14hnYuBo",REACT_APP_SUPABASE_SERVICE_ROLE_KEY:"your-supabase-service-role-key-here",REACT_APP_SECRET_KEY:"PapillonLabs_Monarch_c3a4196059e92e4af0753274e01fa917",REACT_APP_ENCRYPTION_KEY:"PapillonLabs_Nectar_dCK2ThywLPW0wHkNbejY9xXsxs",REACT_APP_JWT_SECRET:"PapillonLabs_Wing_ba948293ebe41b1523f9f7de32f90cc8d53a7e68",REACT_APP_BETA_PASSWORD:"papillon2025",REACT_APP_NAME:"Monarch Passport MVP",REACT_APP_VERSION:"0.1.0",REACT_APP_DEFAULT_THEME_MODE:"dark",REACT_APP_DEFAULT_GRADIENT:"monarch",REACT_APP_DEFAULT_THEME:"frequencyPulse",REACT_APP_BASE_URL:"https://passport.papillonbrand.us/",REACT_APP_BETA_FEATURES_ENABLED:"false",REACT_APP_DEBUG_MODE:"false",REACT_APP_RATE_LIMIT_SCANS:"10",REACT_APP_RATE_LIMIT_LOGINS:"5",REACT_APP_SESSION_TIMEOUT:"60",REACT_APP_MAX_FILE_SIZE:"5242880",REACT_APP_ALLOWED_FILE_TYPES:"image/jpeg,image/png,image/webp",REACT_APP_ANALYTICS_ID:"your-analytics-id-here",REACT_APP_SENTRY_DSN:"your-sentry-dsn-here"}.REACT_APP_RATE_LIMIT_LOGIN_KEY||"login"},API:{window:6e4,limit:parseInt({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://ywagbnjejhpdujkftbxq.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl3YWdibmplamhwZHVqa2Z0YnhxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MjY3NDQsImV4cCI6MjA2NTQwMjc0NH0.veG_QjcIYid1p7R13ERwz9r02VgkkHTOHxW14hnYuBo",REACT_APP_SUPABASE_SERVICE_ROLE_KEY:"your-supabase-service-role-key-here",REACT_APP_SECRET_KEY:"PapillonLabs_Monarch_c3a4196059e92e4af0753274e01fa917",REACT_APP_ENCRYPTION_KEY:"PapillonLabs_Nectar_dCK2ThywLPW0wHkNbejY9xXsxs",REACT_APP_JWT_SECRET:"PapillonLabs_Wing_ba948293ebe41b1523f9f7de32f90cc8d53a7e68",REACT_APP_BETA_PASSWORD:"papillon2025",REACT_APP_NAME:"Monarch Passport MVP",REACT_APP_VERSION:"0.1.0",REACT_APP_DEFAULT_THEME_MODE:"dark",REACT_APP_DEFAULT_GRADIENT:"monarch",REACT_APP_DEFAULT_THEME:"frequencyPulse",REACT_APP_BASE_URL:"https://passport.papillonbrand.us/",REACT_APP_BETA_FEATURES_ENABLED:"false",REACT_APP_DEBUG_MODE:"false",REACT_APP_RATE_LIMIT_SCANS:"10",REACT_APP_RATE_LIMIT_LOGINS:"5",REACT_APP_SESSION_TIMEOUT:"60",REACT_APP_MAX_FILE_SIZE:"5242880",REACT_APP_ALLOWED_FILE_TYPES:"image/jpeg,image/png,image/webp",REACT_APP_ANALYTICS_ID:"your-analytics-id-here",REACT_APP_SENTRY_DSN:"your-sentry-dsn-here"}.REACT_APP_RATE_LIMIT_API)||100,key:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://ywagbnjejhpdujkftbxq.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl3YWdibmplamhwZHVqa2Z0YnhxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MjY3NDQsImV4cCI6MjA2NTQwMjc0NH0.veG_QjcIYid1p7R13ERwz9r02VgkkHTOHxW14hnYuBo",REACT_APP_SUPABASE_SERVICE_ROLE_KEY:"your-supabase-service-role-key-here",REACT_APP_SECRET_KEY:"PapillonLabs_Monarch_c3a4196059e92e4af0753274e01fa917",REACT_APP_ENCRYPTION_KEY:"PapillonLabs_Nectar_dCK2ThywLPW0wHkNbejY9xXsxs",REACT_APP_JWT_SECRET:"PapillonLabs_Wing_ba948293ebe41b1523f9f7de32f90cc8d53a7e68",REACT_APP_BETA_PASSWORD:"papillon2025",REACT_APP_NAME:"Monarch Passport MVP",REACT_APP_VERSION:"0.1.0",REACT_APP_DEFAULT_THEME_MODE:"dark",REACT_APP_DEFAULT_GRADIENT:"monarch",REACT_APP_DEFAULT_THEME:"frequencyPulse",REACT_APP_BASE_URL:"https://passport.papillonbrand.us/",REACT_APP_BETA_FEATURES_ENABLED:"false",REACT_APP_DEBUG_MODE:"false",REACT_APP_RATE_LIMIT_SCANS:"10",REACT_APP_RATE_LIMIT_LOGINS:"5",REACT_APP_SESSION_TIMEOUT:"60",REACT_APP_MAX_FILE_SIZE:"5242880",REACT_APP_ALLOWED_FILE_TYPES:"image/jpeg,image/png,image/webp",REACT_APP_ANALYTICS_ID:"your-analytics-id-here",REACT_APP_SENTRY_DSN:"your-sentry-dsn-here"}.REACT_APP_RATE_LIMIT_API_KEY||"api"},FILE_UPLOAD:{window:6e4,limit:parseInt({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://ywagbnjejhpdujkftbxq.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl3YWdibmplamhwZHVqa2Z0YnhxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MjY3NDQsImV4cCI6MjA2NTQwMjc0NH0.veG_QjcIYid1p7R13ERwz9r02VgkkHTOHxW14hnYuBo",REACT_APP_SUPABASE_SERVICE_ROLE_KEY:"your-supabase-service-role-key-here",REACT_APP_SECRET_KEY:"PapillonLabs_Monarch_c3a4196059e92e4af0753274e01fa917",REACT_APP_ENCRYPTION_KEY:"PapillonLabs_Nectar_dCK2ThywLPW0wHkNbejY9xXsxs",REACT_APP_JWT_SECRET:"PapillonLabs_Wing_ba948293ebe41b1523f9f7de32f90cc8d53a7e68",REACT_APP_BETA_PASSWORD:"papillon2025",REACT_APP_NAME:"Monarch Passport MVP",REACT_APP_VERSION:"0.1.0",REACT_APP_DEFAULT_THEME_MODE:"dark",REACT_APP_DEFAULT_GRADIENT:"monarch",REACT_APP_DEFAULT_THEME:"frequencyPulse",REACT_APP_BASE_URL:"https://passport.papillonbrand.us/",REACT_APP_BETA_FEATURES_ENABLED:"false",REACT_APP_DEBUG_MODE:"false",REACT_APP_RATE_LIMIT_SCANS:"10",REACT_APP_RATE_LIMIT_LOGINS:"5",REACT_APP_SESSION_TIMEOUT:"60",REACT_APP_MAX_FILE_SIZE:"5242880",REACT_APP_ALLOWED_FILE_TYPES:"image/jpeg,image/png,image/webp",REACT_APP_ANALYTICS_ID:"your-analytics-id-here",REACT_APP_SENTRY_DSN:"your-sentry-dsn-here"}.REACT_APP_RATE_LIMIT_FILE_UPLOAD)||5,key:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://ywagbnjejhpdujkftbxq.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl3YWdibmplamhwZHVqa2Z0YnhxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MjY3NDQsImV4cCI6MjA2NTQwMjc0NH0.veG_QjcIYid1p7R13ERwz9r02VgkkHTOHxW14hnYuBo",REACT_APP_SUPABASE_SERVICE_ROLE_KEY:"your-supabase-service-role-key-here",REACT_APP_SECRET_KEY:"PapillonLabs_Monarch_c3a4196059e92e4af0753274e01fa917",REACT_APP_ENCRYPTION_KEY:"PapillonLabs_Nectar_dCK2ThywLPW0wHkNbejY9xXsxs",REACT_APP_JWT_SECRET:"PapillonLabs_Wing_ba948293ebe41b1523f9f7de32f90cc8d53a7e68",REACT_APP_BETA_PASSWORD:"papillon2025",REACT_APP_NAME:"Monarch Passport MVP",REACT_APP_VERSION:"0.1.0",REACT_APP_DEFAULT_THEME_MODE:"dark",REACT_APP_DEFAULT_GRADIENT:"monarch",REACT_APP_DEFAULT_THEME:"frequencyPulse",REACT_APP_BASE_URL:"https://passport.papillonbrand.us/",REACT_APP_BETA_FEATURES_ENABLED:"false",REACT_APP_DEBUG_MODE:"false",REACT_APP_RATE_LIMIT_SCANS:"10",REACT_APP_RATE_LIMIT_LOGINS:"5",REACT_APP_SESSION_TIMEOUT:"60",REACT_APP_MAX_FILE_SIZE:"5242880",REACT_APP_ALLOWED_FILE_TYPES:"image/jpeg,image/png,image/webp",REACT_APP_ANALYTICS_ID:"your-analytics-id-here",REACT_APP_SENTRY_DSN:"your-sentry-dsn-here"}.REACT_APP_RATE_LIMIT_FILE_KEY||"file_upload"},PROFILE_UPDATE:{window:6e4,limit:parseInt({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://ywagbnjejhpdujkftbxq.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl3YWdibmplamhwZHVqa2Z0YnhxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MjY3NDQsImV4cCI6MjA2NTQwMjc0NH0.veG_QjcIYid1p7R13ERwz9r02VgkkHTOHxW14hnYuBo",REACT_APP_SUPABASE_SERVICE_ROLE_KEY:"your-supabase-service-role-key-here",REACT_APP_SECRET_KEY:"PapillonLabs_Monarch_c3a4196059e92e4af0753274e01fa917",REACT_APP_ENCRYPTION_KEY:"PapillonLabs_Nectar_dCK2ThywLPW0wHkNbejY9xXsxs",REACT_APP_JWT_SECRET:"PapillonLabs_Wing_ba948293ebe41b1523f9f7de32f90cc8d53a7e68",REACT_APP_BETA_PASSWORD:"papillon2025",REACT_APP_NAME:"Monarch Passport MVP",REACT_APP_VERSION:"0.1.0",REACT_APP_DEFAULT_THEME_MODE:"dark",REACT_APP_DEFAULT_GRADIENT:"monarch",REACT_APP_DEFAULT_THEME:"frequencyPulse",REACT_APP_BASE_URL:"https://passport.papillonbrand.us/",REACT_APP_BETA_FEATURES_ENABLED:"false",REACT_APP_DEBUG_MODE:"false",REACT_APP_RATE_LIMIT_SCANS:"10",REACT_APP_RATE_LIMIT_LOGINS:"5",REACT_APP_SESSION_TIMEOUT:"60",REACT_APP_MAX_FILE_SIZE:"5242880",REACT_APP_ALLOWED_FILE_TYPES:"image/jpeg,image/png,image/webp",REACT_APP_ANALYTICS_ID:"your-analytics-id-here",REACT_APP_SENTRY_DSN:"your-sentry-dsn-here"}.REACT_APP_RATE_LIMIT_PROFILE)||10,key:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://ywagbnjejhpdujkftbxq.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl3YWdibmplamhwZHVqa2Z0YnhxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MjY3NDQsImV4cCI6MjA2NTQwMjc0NH0.veG_QjcIYid1p7R13ERwz9r02VgkkHTOHxW14hnYuBo",REACT_APP_SUPABASE_SERVICE_ROLE_KEY:"your-supabase-service-role-key-here",REACT_APP_SECRET_KEY:"PapillonLabs_Monarch_c3a4196059e92e4af0753274e01fa917",REACT_APP_ENCRYPTION_KEY:"PapillonLabs_Nectar_dCK2ThywLPW0wHkNbejY9xXsxs",REACT_APP_JWT_SECRET:"PapillonLabs_Wing_ba948293ebe41b1523f9f7de32f90cc8d53a7e68",REACT_APP_BETA_PASSWORD:"papillon2025",REACT_APP_NAME:"Monarch Passport MVP",REACT_APP_VERSION:"0.1.0",REACT_APP_DEFAULT_THEME_MODE:"dark",REACT_APP_DEFAULT_GRADIENT:"monarch",REACT_APP_DEFAULT_THEME:"frequencyPulse",REACT_APP_BASE_URL:"https://passport.papillonbrand.us/",REACT_APP_BETA_FEATURES_ENABLED:"false",REACT_APP_DEBUG_MODE:"false",REACT_APP_RATE_LIMIT_SCANS:"10",REACT_APP_RATE_LIMIT_LOGINS:"5",REACT_APP_SESSION_TIMEOUT:"60",REACT_APP_MAX_FILE_SIZE:"5242880",REACT_APP_ALLOWED_FILE_TYPES:"image/jpeg,image/png,image/webp",REACT_APP_ANALYTICS_ID:"your-analytics-id-here",REACT_APP_SENTRY_DSN:"your-sentry-dsn-here"}.REACT_APP_RATE_LIMIT_PROFILE_KEY||"profile_update"},REWARD_CLAIM:{window:6e4,limit:parseInt({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://ywagbnjejhpdujkftbxq.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl3YWdibmplamhwZHVqa2Z0YnhxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MjY3NDQsImV4cCI6MjA2NTQwMjc0NH0.veG_QjcIYid1p7R13ERwz9r02VgkkHTOHxW14hnYuBo",REACT_APP_SUPABASE_SERVICE_ROLE_KEY:"your-supabase-service-role-key-here",REACT_APP_SECRET_KEY:"PapillonLabs_Monarch_c3a4196059e92e4af0753274e01fa917",REACT_APP_ENCRYPTION_KEY:"PapillonLabs_Nectar_dCK2ThywLPW0wHkNbejY9xXsxs",REACT_APP_JWT_SECRET:"PapillonLabs_Wing_ba948293ebe41b1523f9f7de32f90cc8d53a7e68",REACT_APP_BETA_PASSWORD:"papillon2025",REACT_APP_NAME:"Monarch Passport MVP",REACT_APP_VERSION:"0.1.0",REACT_APP_DEFAULT_THEME_MODE:"dark",REACT_APP_DEFAULT_GRADIENT:"monarch",REACT_APP_DEFAULT_THEME:"frequencyPulse",REACT_APP_BASE_URL:"https://passport.papillonbrand.us/",REACT_APP_BETA_FEATURES_ENABLED:"false",REACT_APP_DEBUG_MODE:"false",REACT_APP_RATE_LIMIT_SCANS:"10",REACT_APP_RATE_LIMIT_LOGINS:"5",REACT_APP_SESSION_TIMEOUT:"60",REACT_APP_MAX_FILE_SIZE:"5242880",REACT_APP_ALLOWED_FILE_TYPES:"image/jpeg,image/png,image/webp",REACT_APP_ANALYTICS_ID:"your-analytics-id-here",REACT_APP_SENTRY_DSN:"your-sentry-dsn-here"}.REACT_APP_RATE_LIMIT_REWARD)||20,key:{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0,REACT_APP_SUPABASE_URL:"https://ywagbnjejhpdujkftbxq.supabase.co",REACT_APP_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl3YWdibmplamhwZHVqa2Z0YnhxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MjY3NDQsImV4cCI6MjA2NTQwMjc0NH0.veG_QjcIYid1p7R13ERwz9r02VgkkHTOHxW14hnYuBo",REACT_APP_SUPABASE_SERVICE_ROLE_KEY:"your-supabase-service-role-key-here",REACT_APP_SECRET_KEY:"PapillonLabs_Monarch_c3a4196059e92e4af0753274e01fa917",REACT_APP_ENCRYPTION_KEY:"PapillonLabs_Nectar_dCK2ThywLPW0wHkNbejY9xXsxs",REACT_APP_JWT_SECRET:"PapillonLabs_Wing_ba948293ebe41b1523f9f7de32f90cc8d53a7e68",REACT_APP_BETA_PASSWORD:"papillon2025",REACT_APP_NAME:"Monarch Passport MVP",REACT_APP_VERSION:"0.1.0",REACT_APP_DEFAULT_THEME_MODE:"dark",REACT_APP_DEFAULT_GRADIENT:"monarch",REACT_APP_DEFAULT_THEME:"frequencyPulse",REACT_APP_BASE_URL:"https://passport.papillonbrand.us/",REACT_APP_BETA_FEATURES_ENABLED:"false",REACT_APP_DEBUG_MODE:"false",REACT_APP_RATE_LIMIT_SCANS:"10",REACT_APP_RATE_LIMIT_LOGINS:"5",REACT_APP_SESSION_TIMEOUT:"60",REACT_APP_MAX_FILE_SIZE:"5242880",REACT_APP_ALLOWED_FILE_TYPES:"image/jpeg,image/png,image/webp",REACT_APP_ANALYTICS_ID:"your-analytics-id-here",REACT_APP_SENTRY_DSN:"your-sentry-dsn-here"}.REACT_APP_RATE_LIMIT_REWARD_KEY||"reward_claim"}};function W(e,s){return"".concat(s,":").concat(e)}function j(){return Date.now()}function B(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{Math.random()<.1&&function(){const e=j();for(const[s,t]of F.entries()){const r=t.filter(s=>e-s<6e4);0===r.length?F.delete(s):F.set(s,r)}}();const r=t||k[s.toUpperCase()];if(!r)throw new Error("Unknown rate limit type: ".concat(s));const{window:i,limit:a,key:n}=r,o=W(e,n),c=j(),_=(F.get(o)||[]).filter(e=>c-e<i);if(_.length>=a){const e=Math.min(..._)+i,s=e-c;return{allowed:!1,limit:a,remaining:0,resetTime:new Date(e).toISOString(),timeUntilReset:Math.ceil(s/1e3),message:"Rate limit exceeded. Try again in ".concat(Math.ceil(s/1e3)," seconds.")}}return _.push(c),F.set(o,_),{allowed:!0,limit:a,remaining:a-_.length,resetTime:new Date(c+i).toISOString(),timeUntilReset:Math.ceil(i/1e3),message:"Rate limit check passed"}}catch(r){return console.error("Rate limit check failed:",r.message),{allowed:!1,error:r.message,message:"Rate limit check failed"}}}function x(e){return B(e,"QR_SCAN")}function H(e){return B(e,"LOGIN")}function V(e){return B(e,"FILE_UPLOAD")}const G="1.0",J=new Map;function K(e){let s=0;const t=JSON.stringify(e);for(let r=0;r<t.length;r++){s=(s<<5)-s+t.charCodeAt(r),s&=s}return Math.abs(s).toString(16)}function Q(e){const s=["version","timestamp","userId","rewardId","nonce"];for(const i of s)if(!e[i])throw new Error("Missing required field: ".concat(i));if(e.version!==G)throw new Error("Unsupported payload version: ".concat(e.version));const t=new Date(e.timestamp),r=new Date;if(Math.abs(r-t)>864e5)throw new Error("QR code has expired");return!0}function z(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"generate";const t="".concat(e,"-").concat(s),r=Date.now();J.has(t)||J.set(t,[]);const i=J.get(t).filter(e=>r-e<6e4);J.set(t,i);const a="generate"===s?10:50;if(i.length>=a)throw new Error("Rate limit exceeded for ".concat(s));return i.push(r),J.set(t,i),!0}function Z(e){try{z(e.userId,"scan"),Q(e);const s=K({version:e.version,timestamp:e.timestamp,userId:e.userId,rewardId:e.rewardId,nonce:e.nonce});if(e.hash!==s)throw new Error("Invalid QR code hash");return{isValid:!0,userId:e.userId,rewardId:e.rewardId,timestamp:e.timestamp}}catch(s){return{isValid:!1,error:s.message}}}const X=[];function q(e){const s=(0,i.A)((0,i.A)({timestamp:(new Date).toISOString()},e),{},{environment:"production"});return X.push(s),X.length>1e3&&X.splice(0,X.length-1e3),o.get("DEBUG_MODE")&&console.log("\ud83d\udd12 Security Event: ".concat(e.type," - ").concat(e.message)),s}function $(e,s){try{const t=I(s,e);if(!t.success)return q({type:"QR_VALIDATION_FAILED",userId:e,error:t.error,message:"QR data validation failed"}),{success:!1,error:t.error,message:"Invalid QR code data"};const r=x(e);if(!r.allowed)return q({type:"QR_RATE_LIMIT_EXCEEDED",userId:e,limit:r.limit,message:"QR scan rate limit exceeded"}),{success:!1,error:"Rate limit exceeded",message:r.message,resetTime:r.resetTime};if(!L(e,"user:qr:scan"))return q({type:"QR_PERMISSION_DENIED",userId:e,message:"User lacks QR scan permission"}),{success:!1,error:"Permission denied",message:"You do not have permission to scan QR codes"};const i=Z(s);return i.success?(q({type:"QR_SCAN_SUCCESS",userId:e,rewardId:i.data.rewardId,message:"QR code scanned successfully"}),{success:!0,data:i.data,message:"QR code scanned successfully"}):(q({type:"QR_VERIFICATION_FAILED",userId:e,error:i.error,message:"QR code verification failed"}),{success:!1,error:i.error,message:"Invalid or expired QR code"})}catch(t){return q({type:"QR_SCAN_ERROR",userId:e,error:t.message,message:"Unexpected error during QR scan"}),{success:!1,error:"Internal error",message:"An unexpected error occurred"}}}function ee(e,s){try{const t=S(s,e);if(!t.success)return q({type:"FILE_VALIDATION_FAILED",userId:e,error:t.error,fileName:null===s||void 0===s?void 0:s.name,fileSize:null===s||void 0===s?void 0:s.size,message:"File upload validation failed"}),{success:!1,error:t.error,message:"Invalid file"};const r=V(e);return r.allowed?L(e,"user:avatar:upload")?(q({type:"FILE_UPLOAD_SUCCESS",userId:e,fileName:t.data.fileName,fileSize:t.data.fileSize,fileType:t.data.fileType,message:"File upload validated successfully"}),{success:!0,data:t.data,message:"File upload validated successfully"}):(q({type:"FILE_PERMISSION_DENIED",userId:e,message:"User lacks file upload permission"}),{success:!1,error:"Permission denied",message:"You do not have permission to upload files"}):(q({type:"FILE_RATE_LIMIT_EXCEEDED",userId:e,limit:r.limit,message:"File upload rate limit exceeded"}),{success:!1,error:"Rate limit exceeded",message:r.message})}catch(t){return q({type:"FILE_UPLOAD_ERROR",userId:e,error:t.message,message:"Unexpected error during file upload"}),{success:!1,error:"Internal error",message:"An unexpected error occurred"}}}function se(e,s){try{const t=p(s,e);return t.success?L(e,"user:profile:edit")?(q({type:"PROFILE_UPDATE_SUCCESS",userId:e,updatedFields:Object.keys(t.data),message:"Profile update validated successfully"}),{success:!0,data:t.data,message:"Profile update validated successfully"}):(q({type:"PROFILE_PERMISSION_DENIED",userId:e,message:"User lacks profile edit permission"}),{success:!1,error:"Permission denied",message:"You do not have permission to edit your profile"}):(q({type:"PROFILE_VALIDATION_FAILED",userId:e,error:t.error,message:"Profile update validation failed"}),{success:!1,error:t.error,message:"Invalid profile data"})}catch(t){return q({type:"PROFILE_UPDATE_ERROR",userId:e,error:t.message,message:"Unexpected error during profile update"}),{success:!1,error:"Internal error",message:"An unexpected error occurred"}}}function te(e,s){try{if(!e||!s)return q({type:"LOGIN_VALIDATION_FAILED",identifier:e,error:"Missing credentials",message:"Login validation failed"}),{success:!1,error:"Invalid credentials",message:"Please provide valid credentials"};const t=H(e);return t.allowed?(q({type:"LOGIN_ATTEMPT",identifier:e,message:"Login attempt validated"}),{success:!0,message:"Login attempt validated"}):(q({type:"LOGIN_RATE_LIMIT_EXCEEDED",identifier:e,limit:t.limit,message:"Login rate limit exceeded"}),{success:!1,error:"Rate limit exceeded",message:t.message})}catch(t){return q({type:"LOGIN_ERROR",identifier:e,error:t.message,message:"Unexpected error during login"}),{success:!1,error:"Internal error",message:"An unexpected error occurred"}}}function re(e,s){try{return M(e,s)?(q({type:"ROUTE_ACCESS_GRANTED",userId:e,route:s,message:"Route access granted"}),{success:!0,message:"Route access granted"}):(q({type:"ROUTE_ACCESS_DENIED",userId:e,route:s,message:"Route access denied"}),{success:!1,error:"Access denied",message:"You do not have permission to access this page"})}catch(t){return q({type:"ROUTE_ACCESS_ERROR",userId:e,route:s,error:t.message,message:"Unexpected error during route access check"}),{success:!1,error:"Internal error",message:"An unexpected error occurred"}}}function ie(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{if(!w(e))return q({type:"ADMIN_ACTION_DENIED",userId:e,action:s,message:"Non-admin user attempted admin action"}),{success:!1,error:"Access denied",message:"Admin privileges required"};const r="admin:".concat(s);return L(e,r)?(q({type:"ADMIN_ACTION_SUCCESS",userId:e,action:s,data:Object.keys(t),message:"Admin action validated successfully"}),{success:!0,message:"Admin action validated successfully"}):(q({type:"ADMIN_PERMISSION_DENIED",userId:e,action:s,permission:r,message:"Admin lacks specific permission"}),{success:!1,error:"Permission denied",message:"You do not have permission to perform: ".concat(s)})}catch(r){return q({type:"ADMIN_ACTION_ERROR",userId:e,action:s,error:r.message,message:"Unexpected error during admin action"}),{success:!1,error:"Internal error",message:"An unexpected error occurred"}}}function ae(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{return U(e)?(q({type:"SUPER_ADMIN_ACTION_SUCCESS",userId:e,action:s,data:Object.keys(t),message:"Super admin action validated successfully"}),{success:!0,message:"Super admin action validated successfully"}):(q({type:"SUPER_ADMIN_ACTION_DENIED",userId:e,action:s,message:"Non-super-admin user attempted super admin action"}),{success:!1,error:"Access denied",message:"Super admin privileges required"})}catch(r){return q({type:"SUPER_ADMIN_ACTION_ERROR",userId:e,action:s,error:r.message,message:"Unexpected error during super admin action"}),{success:!1,error:"Internal error",message:"An unexpected error occurred"}}}function ne(){return{timestamp:(new Date).toISOString(),securityEvents:X.length,recentEvents:X.slice(-10),systemStatus:{configuration:o.audit(),qrSecurity:{timestamp:(new Date).toISOString(),rateLimits:J.size,activeUsers:new Set([...J.keys()].map(e=>e.split("-")[0])).size,version:G},inputValidation:"Input validation system active",rbac:"RBAC system active",rateLimiting:"Rate limiting system active"}}}const oe=new class{constructor(){this.alerts=[],this.threatLevel="LOW",this.suspiciousActivities=new Map,this.blockedIPs=new Set,this.securityMetrics={totalScans:0,failedScans:0,suspiciousActivities:0,blockedAttempts:0,securityAlerts:0}}trackSuspiciousActivity(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r="".concat(e,":").concat(s),i=Date.now();this.suspiciousActivities.has(r)||this.suspiciousActivities.set(r,[]);const a=this.suspiciousActivities.get(r).filter(e=>i-e<3e5);a.push(i),this.suspiciousActivities.set(r,a),a.length>=10&&(this.createAlert("SUSPICIOUS_ACTIVITY",{userId:e,activity:s,count:a.length,details:t}),this.securityMetrics.suspiciousActivities++)}createAlert(e,s){const t={id:Date.now().toString(),timestamp:(new Date).toISOString(),type:e,data:s,severity:this.getAlertSeverity(e),acknowledged:!1};return this.alerts.push(t),this.securityMetrics.securityAlerts++,this.updateThreatLevel(),o.get("DEBUG_MODE")&&console.warn("\ud83d\udea8 Security Alert: ".concat(e),s),t}getAlertSeverity(e){return{SUSPICIOUS_ACTIVITY:"MEDIUM",RATE_LIMIT_EXCEEDED:"HIGH",UNAUTHORIZED_ACCESS:"HIGH",MALICIOUS_INPUT:"HIGH",SYSTEM_ERROR:"LOW",PERMISSION_VIOLATION:"MEDIUM"}[e]||"LOW"}updateThreatLevel(){const e=this.alerts.filter(e=>"HIGH"===e.severity&&!e.acknowledged).length,s=this.alerts.filter(e=>"MEDIUM"===e.severity&&!e.acknowledged).length;this.threatLevel=e>=3?"CRITICAL":e>=1||s>=5?"HIGH":s>=2?"MEDIUM":"LOW"}getSecurityStatus(){return{threatLevel:this.threatLevel,alerts:this.alerts.filter(e=>!e.acknowledged),metrics:this.securityMetrics,suspiciousActivities:this.suspiciousActivities.size,blockedIPs:this.blockedIPs.size}}acknowledgeAlert(e){const s=this.alerts.find(s=>s.id===e);s&&(s.acknowledged=!0,this.updateThreatLevel())}clearOldAlerts(){const e=Date.now()-864e5;this.alerts=this.alerts.filter(s=>new Date(s.timestamp).getTime()>e)}},ce=new class{constructor(){this.policies={"default-src":["'self'"],"script-src":["'self'","'unsafe-inline'","'unsafe-eval'","https://cdn.jsdelivr.net","https://unpkg.com"],"style-src":["'self'","'unsafe-inline'","https://fonts.googleapis.com"],"font-src":["'self'","https://fonts.gstatic.com","data:"],"img-src":["'self'","data:","https:","blob:"],"connect-src":["'self'","https://*.supabase.co","https://*.vercel.app","wss://*.supabase.co"],"frame-src":["'none'"],"object-src":["'none'"],"base-uri":["'self'"],"form-action":["'self'"],"frame-ancestors":["'none'"],"upgrade-insecure-requests":[]}}getCSPHeader(){return Object.entries(this.policies).map(e=>{let[s,t]=e;return 0===t.length?s:"".concat(s," ").concat(t.join(" "))}).join("; ")}addDevelopmentPolicy(){this.policies["script-src"].push("http://localhost:*"),this.policies["connect-src"].push("http://localhost:*")}getStrictPolicy(){const e=(0,i.A)({},this.policies);return e["script-src"]=e["script-src"].filter(e=>!e.includes("unsafe")),e["style-src"]=e["style-src"].filter(e=>!e.includes("unsafe")),Object.entries(e).map(e=>{let[s,t]=e;return 0===t.length?s:"".concat(s," ").concat(t.join(" "))}).join("; ")}},_e=new class{constructor(){this.scanHistory=new Map,this.blockedCodes=new Set,this.verificationCache=new Map}async enhancedQRScan(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{const r=$(e,s);if(!r.success)return r;const i="".concat(e,":").concat(s);if(this.scanHistory.has(i)){const e=this.scanHistory.get(i);if(Date.now()-e.timestamp<6e4)return{success:!1,error:"Duplicate scan",message:"This QR code was recently scanned. Please wait before scanning again."}}if(this.blockedCodes.has(s))return{success:!1,error:"Blocked code",message:"This QR code has been blocked due to suspicious activity."};const a=I(s,e);if(!a.success)return a;const n=this.scanHistory.get(e)||[];return n.filter(e=>Date.now()-e.timestamp<3e5).length>=20?{success:!1,error:"Rate limit exceeded",message:"Too many scans in a short time. Please wait before scanning again."}:(this.scanHistory.set(i,{timestamp:Date.now(),userId:e,context:t}),this.verificationCache.set(s,{timestamp:Date.now(),result:r.data}),{success:!0,data:r.data,message:"QR code scanned successfully with enhanced security"})}catch(r){return{success:!1,error:"Enhanced security error",message:"An error occurred during enhanced security checks"}}}blockQRCode(e,s){this.blockedCodes.add(e),o.get("DEBUG_MODE")&&console.warn("\ud83d\udeab QR Code blocked: ".concat(e.substring(0,20),"... - ").concat(s))}getScanStatistics(){return{totalScans:this.scanHistory.size,blockedCodes:this.blockedCodes.size,cachedVerifications:this.verificationCache.size,uniqueUsers:new Set([...this.scanHistory.values()].map(e=>e.userId)).size}}clearOldScans(){const e=Date.now()-36e5;for(const[s,t]of this.scanHistory.entries())t.timestamp<e&&this.scanHistory.delete(s);for(const[s,t]of this.verificationCache.entries())t.timestamp<e&&this.verificationCache.delete(s)}},Ee=new class{constructor(){this.activeSessions=new Map,this.sessionTimeout=o.get("SESSION_TIMEOUT")||3600}createSession(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const t=this.generateSessionId(),r={id:t,userId:e,createdAt:Date.now(),lastActivity:Date.now(),data:s,ip:s.ip||"unknown",userAgent:s.userAgent||"unknown"};return this.activeSessions.set(t,r),t}validateSession(e){const s=this.activeSessions.get(e);if(!s)return{valid:!1,reason:"Session not found"};const t=Date.now(),r=t-s.lastActivity,i=t-s.createdAt;return r>1e3*this.sessionTimeout?(this.activeSessions.delete(e),{valid:!1,reason:"Session expired"}):i>864e5?(this.activeSessions.delete(e),{valid:!1,reason:"Session too old"}):(s.lastActivity=t,{valid:!0,session:s})}invalidateSession(e){this.activeSessions.delete(e)}invalidateUserSessions(e){for(const[s,t]of this.activeSessions.entries())t.userId===e&&this.activeSessions.delete(s)}generateSessionId(){const e=new Uint8Array(32);if("undefined"!==typeof window&&window.crypto)window.crypto.getRandomValues(e);else for(let s=0;s<32;s++)e[s]=Math.floor(256*Math.random());return Array.from(e,e=>e.toString(16).padStart(2,"0")).join("")}getSessionStatistics(){return{activeSessions:this.activeSessions.size,uniqueUsers:new Set([...this.activeSessions.values()].map(e=>e.userId)).size,averageSessionAge:this.getAverageSessionAge()}}getAverageSessionAge(){if(0===this.activeSessions.size)return 0;const e=Date.now();return[...this.activeSessions.values()].reduce((s,t)=>s+(e-t.createdAt),0)/this.activeSessions.size}cleanupExpiredSessions(){const e=Date.now(),s=1e3*this.sessionTimeout;for(const[t,r]of this.activeSessions.entries())e-r.lastActivity>s&&this.activeSessions.delete(t)}};const Ae={enhancedQRScan:(e,s,t)=>_e.enhancedQRScan(e,s,t),blockQRCode:(e,s)=>_e.blockQRCode(e,s),getQRStatistics:()=>_e.getScanStatistics(),createSession:(e,s)=>Ee.createSession(e,s),validateSession:e=>Ee.validateSession(e),invalidateSession:e=>Ee.invalidateSession(e),invalidateUserSessions:e=>Ee.invalidateUserSessions(e),trackSuspiciousActivity:(e,s,t)=>oe.trackSuspiciousActivity(e,s,t),createAlert:(e,s)=>oe.createAlert(e,s),getSecurityStatus:()=>oe.getSecurityStatus(),acknowledgeAlert:e=>oe.acknowledgeAlert(e),getCSPHeader:()=>ce.getCSPHeader(),getStrictCSPHeader:()=>ce.getStrictPolicy(),enhancedValidateQR:(e,s)=>I(e,s),enhancedValidateFile:(e,s)=>S(e,s),enhancedValidateProfile:(e,s)=>p(e,s),secureQRScan:$,secureFileUpload:ee,secureProfileUpdate:se,secureLogin:te,secureRouteAccess:re,secureAdminAction:ie,secureSuperAdminAction:ae,hasPermission:L,isAdmin:w,isSuperAdmin:U,auditSecurity:()=>({securitySystem:ne(),inputValidation:m(),rbac:Y(),qrStatistics:_e.getScanStatistics(),sessionStatistics:Ee.getSessionStatistics(),securityStatus:oe.getSecurityStatus()}),cleanup:()=>{oe.clearOldAlerts(),_e.clearOldScans(),Ee.cleanupExpiredSessions()}}}}]);
//# sourceMappingURL=749.c479be06.chunk.js.map