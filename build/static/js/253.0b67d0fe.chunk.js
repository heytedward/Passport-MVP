"use strict";(self.webpackChunkmonarch_passport_mvp=self.webpackChunkmonarch_passport_mvp||[]).push([[253],{1949:(n,e,r)=>{r.d(e,{A:()=>d});var t,o,a=r(7528),i=r(5464);const s=(0,i.i7)(t||(t=(0,a.A)(["\n  0%, 100% { \n    box-shadow: \n      0 0 12px 0 rgba(255,215,0,0.15),\n      0 0 24px 0 rgba(255,215,0,0.08),\n      inset 0 1px 0 rgba(255,215,0,0.1);\n  }\n  50% { \n    box-shadow: \n      0 0 20px 0 rgba(255,215,0,0.3),\n      0 0 40px 0 rgba(255,215,0,0.15),\n      inset 0 1px 0 rgba(255,215,0,0.2);\n  }\n"]))),d=i.Ay.div(o||(o=(0,a.A)(["\n  position: relative;\n  background: ",";\n  border-radius: 20px;\n  border: 3px solid ",";\n  box-shadow: \n    0 0 12px 0 rgba(255,215,0,0.15),\n    0 0 24px 0 rgba(255,215,0,0.08),\n    inset 0 1px 0 rgba(255,215,0,0.1);\n  backdrop-filter: blur(18px);\n  -webkit-backdrop-filter: blur(18px);\n  overflow: hidden;\n  transition: transform 0.18s cubic-bezier(0.4,0,0.2,1), box-shadow 0.18s, border 0.18s;\n  \n  &:hover {\n    transform: translateY(-3px) scale(1.02);\n    border: 3px solid ",";\n    box-shadow: \n      0 0 20px 0 rgba(255,215,0,0.3),\n      0 0 40px 0 rgba(255,215,0,0.15),\n      inset 0 1px 0 rgba(255,215,0,0.2);\n    animation: "," 2s ease-in-out infinite;\n  }\n  \n  /* Content positioning */\n  > * {\n    position: relative;\n    z-index: 1;\n  }\n"])),n=>{var e,r;let{theme:t}=n;return(null===(e=t.colors)||void 0===e||null===(r=e.glass)||void 0===r?void 0:r.background)||"linear-gradient(135deg, rgba(20,20,20,0.95) 0%, rgba(30,30,30,0.90) 50%, rgba(15,15,15,0.98) 100%)"},n=>{var e,r;let{theme:t}=n;return(null===(e=t.colors)||void 0===e||null===(r=e.accent)||void 0===r?void 0:r.gold)||"#FFD700"},n=>{var e,r;let{theme:t}=n;return(null===(e=t.colors)||void 0===e||null===(r=e.accent)||void 0===r?void 0:r.gold)||"#FFD700"},s)},7253:(n,e,r)=>{r.r(e),r.d(e,{default:()=>$n});var t,o,a,i,s,d,l,c,p,g=r(7528),x=r(5043),u=r(5464),m=r(1949),h=r(3216),b=r(342),f=r(9708),y=r(7337),w=r(2507),v=r(579);const A=(0,w.UU)("https://ywagbnjejhpdujkftbxq.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl3YWdibmplamhwZHVqa2Z0YnhxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDk4MjY3NDQsImV4cCI6MjA2NTQwMjc0NH0.veG_QjcIYid1p7R13ERwz9r02VgkkHTOHxW14hnYuBo"),k=u.Ay.div(t||(t=(0,g.A)(["\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 1rem;\n"]))),F=u.Ay.div(o||(o=(0,g.A)(["\n  position: relative;\n  border-radius: 50%;\n  overflow: hidden;\n  background: linear-gradient(135deg, #1a1a2e, #16213e);\n  border: 2px solid #FFB000;\n  box-shadow: 0 0 10px rgba(255, 176, 0, 0.2);\n"]))),j=u.Ay.img(a||(a=(0,g.A)(["\n  width: 100%;\n  height: 100%;\n  object-fit: cover;\n  border-radius: 50%;\n"]))),C=u.Ay.div(i||(i=(0,g.A)(["\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: ","px;\n  color: #FFB000;\n  background: linear-gradient(135deg, #1a1a2e, #16213e);\n"])),n=>Math.max(20,.4*n.size)),z=u.Ay.div(s||(s=(0,g.A)(["\n  position: absolute;\n  top: 0;\n  left: 0;\n  right: 0;\n  bottom: 0;\n  background: rgba(0, 0, 0, 0.7);\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-size: 1.5rem;\n  color: #FFB000;\n  border-radius: 50%;\n"]))),E=u.Ay.button(d||(d=(0,g.A)(["\n  background: linear-gradient(135deg, #FFB000, #FFCA28);\n  color: #000;\n  border: none;\n  padding: 0.75rem 1.5rem;\n  border-radius: 25px;\n  font-weight: bold;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  font-size: 0.9rem;\n  min-width: 120px;\n\n  &:hover:not(:disabled) {\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(255, 176, 0, 0.3);\n  }\n\n  &:disabled {\n    opacity: 0.6;\n    cursor: not-allowed;\n    transform: none;\n  }\n"]))),S=u.Ay.input(l||(l=(0,g.A)(["\n  display: none;\n"]))),P=u.Ay.div(c||(c=(0,g.A)(["\n  color: #ff6b6b;\n  font-size: 0.85rem;\n  text-align: center;\n  margin-top: 0.5rem;\n  padding: 0.5rem;\n  background: rgba(255, 107, 107, 0.1);\n  border-radius: 8px;\n  border: 1px solid rgba(255, 107, 107, 0.3);\n"]))),B=u.Ay.div(p||(p=(0,g.A)(["\n  color: #51cf66;\n  font-size: 0.85rem;\n  text-align: center;\n  margin-top: 0.5rem;\n  padding: 0.5rem;\n  background: rgba(81, 207, 102, 0.1);\n  border-radius: 8px;\n  border: 1px solid rgba(81, 207, 102, 0.3);\n"]))),I=n=>{let{userId:e,currentAvatarUrl:r,onAvatarUpdate:t,size:o=120,showButton:a=!0}=n;const{refreshProfile:i,updateAvatarUrl:s,refreshAvatarUrl:d}=(0,b.A)(),[l,c]=(0,x.useState)(r),[p,g]=(0,x.useState)(!1),[u,m]=(0,x.useState)(""),[h,f]=(0,x.useState)(""),y=(0,x.useRef)();(0,x.useEffect)(()=>{c(r)},[r]);const w=async n=>{try{g(!0),m(""),f(""),console.log("\ud83e\udd8b Starting avatar upload for user:",e);const o=new Promise((n,e)=>{setTimeout(()=>e(new Error("Upload timeout - please try again")),3e4)});(n=>{if(n.size>5242880)throw new Error("File size must be less than 5MB");if(!["image/jpeg","image/jpg","image/png","image/webp"].includes(n.type))throw new Error("Please select a JPEG, PNG, or WebP image")})(n);const a=n.name.split(".").pop(),l="".concat(e,"-").concat(Date.now(),".").concat(a),p="".concat(e,"/").concat(l);console.log("\ud83d\udcc1 Upload parameters:",{fileName:l,filePath:p});const x=(async()=>{console.log("\ud83d\ude80 Uploading to Supabase storage...");const{error:r}=await A.storage.from("avatars").upload(p,n,{cacheControl:"3600",upsert:!0});if(r)throw console.error("\u274c Storage upload error:",r),new Error("Storage upload failed: ".concat(r.message));console.log("\u2705 File uploaded to storage successfully");const{data:t}=A.storage.from("avatars").getPublicUrl(p),o=t.publicUrl;console.log("\ud83d\udd17 Public URL generated:",o),console.log("\ud83d\udcbe Updating user profile in database...");const{data:a,error:i}=await A.from("user_profiles").upsert({id:e,avatar_url:o,updated_at:(new Date).toISOString()},{onConflict:"id"}).select();if(i)throw console.error("\u274c Database update error:",i),"42501"===i.code?new Error("Permission denied - please contact support"):"23505"===i.code?new Error("Profile already exists - please try again"):new Error("Database update failed: ".concat(i.message));return console.log("\u2705 Database updated successfully:",a),o})(),u=await Promise.race([x,o]);c(u),f("Profile picture updated successfully! \ud83e\udd8b"),console.log("\ud83d\udd04 Updating useAuth context..."),s(u),console.log("\ud83d\udd04 Refreshing auth context...");try{await i(),console.log("\u2705 Auth context refreshed")}catch(r){console.warn("\u26a0\ufe0f Failed to refresh auth context:",r)}console.log("\ud83d\udd04 Refreshing avatar URL with cache busting..."),d(),t&&(console.log("\ud83d\udcde Calling onAvatarUpdate callback..."),t(u)),setTimeout(()=>f(""),3e3)}catch(u){console.error("\ud83d\udca5 Avatar upload error:",u),m(u.message||"Failed to upload image. Please try again."),setTimeout(()=>m(""),5e3)}finally{g(!1)}};return(0,v.jsxs)(k,{children:[(0,v.jsxs)(F,{style:{width:o,height:o},children:[l?(0,v.jsx)(j,{src:l,alt:"User avatar",onError:()=>c(null)}):(0,v.jsx)(C,{size:o,children:"\ud83e\udd8b"}),p&&(0,v.jsx)(z,{children:"\u23f3"})]}),a&&(0,v.jsx)(E,{onClick:()=>{var n;null===(n=y.current)||void 0===n||n.click()},disabled:p,children:p?"Uploading...":"Change Picture"}),(0,v.jsx)(S,{ref:y,type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",onChange:n=>{const e=n.target.files[0];e&&w(e),n.target.value=""}}),u&&(0,v.jsx)(P,{children:u}),h&&(0,v.jsx)(B,{children:h})]})};var D,T,U,Y,_,N,O,R,M,G,J,L,W,Z,H=r(2038);const Q=u.Ay.div(D||(D=(0,g.A)(["\n  margin: 20px 0;\n  padding: 20px;\n  background: var(--theme-card-bg, rgba(255, 255, 255, 0.1));\n  border: var(--theme-card-border, 1px solid rgba(255, 255, 255, 0.2));\n  border-radius: 16px;\n  backdrop-filter: var(--theme-card-blur, blur(10px));\n"]))),V=u.Ay.h3(T||(T=(0,g.A)(["\n  color: var(--theme-text-primary, #FFFFFF);\n  font-size: 1.25rem;\n  font-weight: 600;\n  margin-bottom: 20px;\n  text-align: center;\n"]))),X=u.Ay.div(U||(U=(0,g.A)(["\n  display: grid;\n  grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));\n  gap: 16px;\n  margin-bottom: 20px;\n"]))),q=u.Ay.div(Y||(Y=(0,g.A)(["\n  position: relative;\n  background: var(--theme-card-bg, rgba(255, 255, 255, 0.1));\n  border: var(--theme-card-border, 1px solid rgba(255, 255, 255, 0.2));\n  border-radius: 12px;\n  padding: 16px;\n  cursor: ",";\n  opacity: ",";\n  transition: all 0.3s ease;\n  backdrop-filter: var(--theme-card-blur, blur(10px));\n\n  &:hover {\n    transform: ",";\n    box-shadow: ",";\n  }\n\n  ","\n\n  ","\n\n  @keyframes pulse {\n    0%, 100% { opacity: 1; }\n    50% { opacity: 0.8; }\n  }\n"])),n=>n.owned?"pointer":"not-allowed",n=>n.owned?1:.6,n=>n.owned?"translateY(-2px)":"none",n=>n.owned?"0 8px 25px rgba(0, 0, 0, 0.3)":"none",n=>n.isCurrent&&"\n    border: 2px solid var(--theme-accent, #FFB000);\n    box-shadow: 0 0 20px rgba(255, 176, 0, 0.3);\n  ",n=>n.isPreview&&"\n    border: 2px solid var(--theme-accent, #FFB000);\n    box-shadow: 0 0 20px rgba(255, 176, 0, 0.5);\n    animation: pulse 2s infinite;\n  "),K=u.Ay.div(_||(_=(0,g.A)(["\n  width: 100%;\n  height: 120px;\n  border-radius: 8px;\n  margin-bottom: 12px;\n  background: ",";\n  position: relative;\n  overflow: hidden;\n\n  &::before {\n    content: '';\n    position: absolute;\n    top: 8px;\n    left: 8px;\n    right: 8px;\n    height: 20px;\n    background: ",";\n    border: ",";\n    border-radius: 4px;\n    backdrop-filter: ",";\n  }\n\n  &::after {\n    content: '';\n    position: absolute;\n    bottom: 8px;\n    left: 8px;\n    right: 8px;\n    height: 32px;\n    background: ",";\n    border-radius: 6px;\n  }\n"])),n=>n.gradient||n.background||"#0A0A0A",n=>n.cardBg||"rgba(255, 255, 255, 0.1)",n=>n.cardBorder||"1px solid rgba(255, 255, 255, 0.2)",n=>n.cardBlur||"blur(10px)",n=>n.buttonGradient||"linear-gradient(135deg, #FFB000 0%, #FFD700 100%)"),$=u.Ay.div(N||(N=(0,g.A)(["\n  color: var(--theme-text-primary, #FFFFFF);\n  font-size: 1rem;\n  font-weight: 600;\n  margin-bottom: 4px;\n"]))),nn=u.Ay.div(O||(O=(0,g.A)(["\n  color: var(--theme-text-secondary, #CCCCCC);\n  font-size: 0.875rem;\n  margin-bottom: 8px;\n"]))),en=u.Ay.div(R||(R=(0,g.A)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-top: 8px;\n"]))),rn=u.Ay.span(M||(M=(0,g.A)(["\n  padding: 4px 8px;\n  border-radius: 12px;\n  font-size: 0.75rem;\n  font-weight: 500;\n  text-transform: uppercase;\n  letter-spacing: 0.5px;\n\n  ","\n\n  ","\n"])),n=>n.owned?"\n    background: var(--theme-success, #10B981);\n    color: white;\n  ":"\n    background: var(--theme-text-muted, #999999);\n    color: var(--theme-text-primary, #FFFFFF);\n  ",n=>n.isCurrent&&"\n    background: var(--theme-accent, #FFB000);\n    color: var(--theme-text-primary, #FFFFFF);\n  "),tn=u.Ay.button(G||(G=(0,g.A)(["\n  background: var(--theme-button-gradient, linear-gradient(135deg, #FFB000 0%, #FFD700 100%));\n  color: var(--theme-text-primary, #FFFFFF);\n  border: none;\n  border-radius: 6px;\n  padding: 6px 12px;\n  font-size: 0.75rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.3s ease;\n\n  &:hover {\n    background: var(--theme-button-hover, linear-gradient(135deg, #E69A00 0%, #E6C200 100%));\n    transform: translateY(-1px);\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    transform: none;\n  }\n"]))),on=u.Ay.button(J||(J=(0,g.A)(["\n  background: var(--theme-button-gradient, linear-gradient(135deg, #FFB000 0%, #FFD700 100%));\n  color: var(--theme-text-primary, #FFFFFF);\n  border: none;\n  border-radius: 8px;\n  padding: 12px 24px;\n  font-size: 0.875rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.3s ease;\n  width: 100%;\n  margin-top: 16px;\n\n  &:hover {\n    background: var(--theme-button-hover, linear-gradient(135deg, #E69A00 0%, #E6C200 100%));\n    transform: translateY(-2px);\n  }\n\n  &:disabled {\n    opacity: 0.5;\n    cursor: not-allowed;\n    transform: none;\n  }\n"]))),an=u.Ay.div(L||(L=(0,g.A)(["\n  background: var(--theme-error, #EF4444);\n  color: white;\n  padding: 12px;\n  border-radius: 8px;\n  margin-bottom: 16px;\n  font-size: 0.875rem;\n"]))),sn=u.Ay.div(W||(W=(0,g.A)(["\n  background: var(--theme-success, #10B981);\n  color: white;\n  padding: 12px;\n  border-radius: 8px;\n  margin-bottom: 16px;\n  font-size: 0.875rem;\n"]))),dn=u.Ay.div(Z||(Z=(0,g.A)(["\n  position: absolute;\n  top: 8px;\n  right: 8px;\n  background: var(--theme-accent, #FFB000);\n  color: var(--theme-text-primary, #FFFFFF);\n  padding: 2px 6px;\n  border-radius: 4px;\n  font-size: 0.625rem;\n  font-weight: 600;\n  text-transform: uppercase;\n"]))),ln=()=>{const{user:n}=(0,b.A)(),{currentTheme:e,ownedThemes:r,loading:t,error:o,previewTheme:a,themes:i,switchTheme:s,previewTheme:d,clearPreview:l,unlockAllThemes:c,ownsTheme:p}=(0,H.D)(),[g,u]=(0,x.useState)(!1),[m,h]=(0,x.useState)(null),[f,y]=(0,x.useState)(null);(0,x.useEffect)(()=>{if(m){const n=setTimeout(()=>h(null),3e3);return()=>clearTimeout(n)}},[m]),(0,x.useEffect)(()=>{if(f){const n=setTimeout(()=>y(null),3e3);return()=>clearTimeout(n)}},[f]);const w=async n=>{if(p(n))try{const r=await s(n);var e;if(r.success)y("Applied ".concat(null===(e=i.find(e=>e.key===n))||void 0===e?void 0:e.name," theme"));else h(r.error||"Failed to apply theme")}catch(r){h("Error applying theme")}else h("Theme not unlocked")};return t?(0,v.jsx)(Q,{children:(0,v.jsx)(V,{children:"Loading themes..."})}):(0,v.jsxs)(Q,{children:[(0,v.jsx)(V,{children:"Theme Testing"}),m&&(0,v.jsx)(an,{children:m}),f&&(0,v.jsx)(sn,{children:f}),o&&(0,v.jsx)(an,{children:o}),(0,v.jsx)(X,{children:i.map(n=>{const r=p(n.key),t=e===n.key,o=a===n.key;return(0,v.jsxs)(q,{owned:r,isCurrent:t,isPreview:o,onClick:()=>r&&w(n.key),children:[o&&(0,v.jsx)(dn,{children:"Preview"}),(0,v.jsx)(K,{gradient:n.colors.backgroundGradient,background:n.colors.background,cardBg:n.colors.cardBackground,cardBorder:n.colors.cardBorder,cardBlur:n.colors.cardBackdropFilter,buttonGradient:n.colors.buttonGradient}),(0,v.jsx)($,{children:n.name}),(0,v.jsx)(nn,{children:n.description}),(0,v.jsxs)(en,{children:[(0,v.jsx)(rn,{owned:r,isCurrent:t,children:t?"Current":r?"Owned":"Locked"}),r&&(0,v.jsxs)("div",{style:{display:"flex",gap:"4px"},children:[!t&&(0,v.jsx)(tn,{onClick:e=>{e.stopPropagation(),w(n.key)},children:"Apply"}),(0,v.jsx)(tn,{onClick:e=>{var r;e.stopPropagation(),o?l():(r=n.key,p(r)?d(r):h("Theme not unlocked"))},children:o?"Clear":"Preview"})]})]})]},n.key)})}),(0,v.jsx)(on,{onClick:async()=>{u(!0),h(null),y(null);try{const n=await c();n.success?y("All themes unlocked for testing"):h(n.error||"Failed to unlock themes")}catch(n){h("Error unlocking themes")}finally{u(!1)}},disabled:g,children:g?"Unlocking...":"Unlock All Themes for Testing"})]})};var cn,pn,gn,xn,un,mn,hn;const bn=u.Ay.div(cn||(cn=(0,g.A)(["\n  background: var(--theme-card-bg, rgba(255, 255, 255, 0.1));\n  border: var(--theme-card-border, 1px solid rgba(255, 255, 255, 0.2));\n  border-radius: 12px;\n  padding: 20px;\n  margin: 16px 0;\n  backdrop-filter: var(--theme-card-blur, blur(10px));\n  text-align: center;\n"]))),fn=u.Ay.h3(pn||(pn=(0,g.A)(["\n  color: var(--theme-error, #EF4444);\n  font-size: 1.125rem;\n  font-weight: 600;\n  margin-bottom: 8px;\n"]))),yn=u.Ay.p(gn||(gn=(0,g.A)(["\n  color: var(--theme-text-secondary, #CCCCCC);\n  font-size: 0.875rem;\n  margin-bottom: 16px;\n  line-height: 1.5;\n"]))),wn=u.Ay.button(xn||(xn=(0,g.A)(["\n  background: var(--theme-button-gradient, linear-gradient(135deg, #FFB000 0%, #FFD700 100%));\n  color: var(--theme-text-primary, #FFFFFF);\n  border: none;\n  border-radius: 8px;\n  padding: 8px 16px;\n  font-size: 0.875rem;\n  font-weight: 500;\n  cursor: pointer;\n  transition: all 0.3s ease;\n\n  &:hover {\n    background: var(--theme-button-hover, linear-gradient(135deg, #E69A00 0%, #E6C200 100%));\n    transform: translateY(-1px);\n  }\n"])));u.Ay.details(un||(un=(0,g.A)(["\n  margin-top: 12px;\n  text-align: left;\n"]))),u.Ay.summary(mn||(mn=(0,g.A)(["\n  color: var(--theme-text-muted, #999999);\n  font-size: 0.75rem;\n  cursor: pointer;\n  margin-bottom: 8px;\n  \n  &:hover {\n    color: var(--theme-text-secondary, #CCCCCC);\n  }\n"]))),u.Ay.pre(hn||(hn=(0,g.A)(["\n  background: rgba(0, 0, 0, 0.3);\n  border-radius: 4px;\n  padding: 8px;\n  font-size: 0.75rem;\n  color: var(--theme-text-muted, #999999);\n  overflow-x: auto;\n  white-space: pre-wrap;\n  word-break: break-word;\n"])));class vn extends x.Component{constructor(n){super(n),this.handleRetry=()=>{this.setState({hasError:!1,error:null,errorInfo:null})},this.handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null,errorCount:0}),this.state.errorCount>2&&window.location.reload()},this.state={hasError:!1,error:null,errorInfo:null,errorCount:0}}static getDerivedStateFromError(n){return{hasError:!0}}componentDidCatch(n,e){console.error("\ud83e\udd8b Monarch Passport Error Boundary caught an error:",n,e),this.setState(r=>({error:n,errorInfo:e,errorCount:r.errorCount+1})),console.group("\ud83e\udd8b Monarch Passport Error Details"),console.error("Error:",n),console.error("Error Info:",e),console.error("Component Stack:",e.componentStack),console.groupEnd()}render(){if(this.state.hasError){const n=this.state.errorCount>1;return(0,v.jsxs)(bn,{children:[(0,v.jsx)(fn,{children:n?"\ud83e\udd8b Multiple Errors Detected":"\ud83e\udd8b Monarch Passport Error"}),(0,v.jsx)(yn,{children:n?"Something went wrong multiple times. This might be a persistent issue.":"Something went wrong with this component. This might be a temporary issue."}),(0,v.jsxs)("div",{style:{display:"flex",gap:"8px",justifyContent:"center"},children:[(0,v.jsx)(wn,{onClick:this.handleRetry,children:"Try Again"}),n&&(0,v.jsx)(wn,{onClick:this.handleReset,children:"Reset & Reload"})]}),!1]})}return this.props.children}}const An=vn;var kn,Fn,jn,Cn,zn,En,Sn,Pn,Bn,In,Dn,Tn,Un,Yn,_n;const Nn=u.Ay.div(kn||(kn=(0,g.A)(["\n  min-height: 100vh;\n  background: ",";\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: flex-start;\n  padding: 20px 16px 120px 16px;\n  position: relative;\n  \n  @media (max-width: 768px) {\n    padding: 16px 12px 100px 12px;\n  }\n  \n  @media (max-width: 480px) {\n    padding: 12px 8px 80px 8px;\n  }\n"])),n=>{let{theme:e}=n;return e.colors.background}),On=u.Ay.button(Fn||(Fn=(0,g.A)(["\n  background: linear-gradient(135deg, #FFB000 0%, #FF9F1C 100%);\n  color: #000;\n  border: none;\n  border-radius: 12px;\n  padding: 12px 20px;\n  font-weight: 600;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  gap: 8px;\n  transition: all 0.2s ease;\n  font-size: 1rem;\n  width: 100%;\n  justify-content: center;\n  margin-top: 24px;\n  \n  @media (max-width: 768px) {\n    padding: 10px 16px;\n    font-size: 0.9rem;\n    margin-top: 20px;\n  }\n  \n  @media (max-width: 480px) {\n    padding: 12px 18px;\n    font-size: 0.85rem;\n    margin-top: 16px;\n  }\n  \n  &:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(255, 176, 0, 0.3);\n  }\n"]))),Rn=u.Ay.h1(jn||(jn=(0,g.A)(["\n  font-family: ",";\n  font-size: 2rem;\n  font-weight: 700;\n  color: ",";\n  margin: 60px 0 32px 0;\n  text-align: center;\n  \n  @media (max-width: 768px) {\n    font-size: 1.75rem;\n    margin: 50px 0 24px 0;\n  }\n  \n  @media (max-width: 480px) {\n    font-size: 1.5rem;\n    margin: 40px 0 20px 0;\n  }\n"])),n=>{let{theme:e}=n;return e.typography.fontFamily.heading},n=>{let{theme:e}=n;return e.colors.text.primary}),Mn=u.Ay.div(Cn||(Cn=(0,g.A)(["\n  width: 100%;\n  max-width: 480px;\n  margin: 0 auto;\n"]))),Gn=(0,u.Ay)(m.A)(zn||(zn=(0,g.A)(["\n  margin-bottom: 24px;\n  border-radius: 18px;\n  overflow: hidden;\n  border: 3px solid ",";\n  box-shadow: \n    0 0 20px 0 rgba(255,215,0,0.2),\n    0 0 40px 0 rgba(255,215,0,0.1),\n    inset 0 1px 0 rgba(255,215,0,0.15);\n  \n  @media (max-width: 768px) {\n    margin-bottom: 20px;\n    border-radius: 16px;\n  }\n  \n  @media (max-width: 480px) {\n    margin-bottom: 16px;\n    border-radius: 14px;\n  }\n"])),n=>{var e,r;let{theme:t}=n;return(null===(e=t.colors)||void 0===e||null===(r=e.accent)||void 0===r?void 0:r.gold)||"#FFD700"}),Jn=u.Ay.button(En||(En=(0,g.A)(["\n  width: 100%;\n  background: none;\n  border: none;\n  outline: none;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 24px 28px;\n  font-size: 1.25rem;\n  font-family: ",";\n  color: ",";\n  font-weight: 700;\n  cursor: pointer;\n  transition: background 0.2s;\n  \n  @media (max-width: 768px) {\n    padding: 20px 24px;\n    font-size: 1.1rem;\n  }\n  \n  @media (max-width: 480px) {\n    padding: 18px 20px;\n    font-size: 1rem;\n  }\n  \n  &:hover, &:focus {\n    background: ",";\n  }\n"])),n=>{let{theme:e}=n;return e.typography.fontFamily.heading},n=>{let{theme:e}=n;return e.colors.text.primary},n=>{let{theme:e}=n;return e.colors.glass}),Ln=u.Ay.div(Sn||(Sn=(0,g.A)(["\n  padding: 0 28px 24px 28px;\n  background: none;\n  animation: fadeIn 0.3s;\n  \n  @media (max-width: 768px) {\n    padding: 0 24px 20px 24px;\n  }\n  \n  @media (max-width: 480px) {\n    padding: 0 20px 16px 20px;\n  }\n  \n  @keyframes fadeIn {\n    from { opacity: 0; transform: translateY(-8px); }\n    to { opacity: 1; transform: translateY(0); }\n  }\n"]))),Wn=u.Ay.div(Pn||(Pn=(0,g.A)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 18px;\n  gap: 18px;\n  \n  @media (max-width: 768px) {\n    margin-bottom: 16px;\n    gap: 16px;\n    flex-wrap: wrap;\n  }\n  \n  @media (max-width: 480px) {\n    margin-bottom: 14px;\n    gap: 12px;\n    flex-direction: column;\n    align-items: flex-start;\n  }\n"]))),Zn=u.Ay.label(Bn||(Bn=(0,g.A)(["\n  font-size: 1.08rem;\n  color: ",";\n  font-weight: 500;\n  \n  @media (max-width: 768px) {\n    font-size: 1rem;\n  }\n  \n  @media (max-width: 480px) {\n    font-size: 0.95rem;\n    width: 100%;\n  }\n"])),n=>{let{theme:e}=n;return e.colors.text.primary}),Hn=u.Ay.input(In||(In=(0,g.A)(["\n  font-size: 1.08rem;\n  padding: 8px 12px;\n  border-radius: 8px;\n  border: 2px solid ",";\n  background: ",";\n  color: ",";\n  transition: all 0.2s ease;\n  max-width: 200px;\n  \n  @media (max-width: 768px) {\n    font-size: 1rem;\n    padding: 6px 10px;\n    max-width: 180px;\n  }\n  \n  @media (max-width: 480px) {\n    font-size: 0.95rem;\n    padding: 8px 12px;\n    max-width: 160px;\n  }\n  \n  &:focus {\n    outline: none;\n    border-color: ",";\n    box-shadow: 0 0 8px rgba(255, 215, 0, 0.3);\n  }\n  \n  &:hover {\n    border-color: ",";\n  }\n"])),n=>{let{theme:e}=n;return e.colors.glass},n=>{let{theme:e}=n;return e.colors.background},n=>{let{theme:e}=n;return e.colors.text.primary},n=>{let{theme:e}=n;return e.colors.accent.gold},n=>{let{theme:e}=n;return e.colors.accent.gold}),Qn=u.Ay.input.attrs({type:"checkbox"})(Dn||(Dn=(0,g.A)(["\n  width: 40px;\n  height: 22px;\n  accent-color: ",";\n  \n  @media (max-width: 480px) {\n    width: 36px;\n    height: 20px;\n  }\n"])),n=>{let{theme:e}=n;return e.colors.accent}),Vn=u.Ay.button(Tn||(Tn=(0,g.A)(["\n  background: ",";\n  color: ",";\n  border: none;\n  border-radius: 8px;\n  padding: 8px 18px;\n  font-size: 1rem;\n  font-weight: 600;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  \n  @media (max-width: 768px) {\n    padding: 6px 14px;\n    font-size: 0.9rem;\n  }\n  \n  @media (max-width: 480px) {\n    padding: 8px 16px;\n    font-size: 0.85rem;\n    width: 100%;\n  }\n  \n  &:hover, &:focus {\n    background: ",";\n    outline: none;\n    transform: translateY(-1px);\n  }\n  \n  &:disabled {\n    opacity: 0.6;\n    cursor: not-allowed;\n    transform: none;\n  }\n"])),n=>{let{theme:e}=n;return e.gradients.primary},n=>{let{theme:e}=n;return e.colors.text.primary},n=>{let{theme:e}=n;return e.gradients.gold}),Xn=u.Ay.button(Un||(Un=(0,g.A)(["\n  background: ",";\n  color: ",";\n  border: none;\n  border-radius: 8px;\n  padding: 8px;\n  font-size: 1rem;\n  cursor: pointer;\n  transition: all 0.2s ease;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  min-width: 36px;\n  height: 36px;\n  \n  @media (max-width: 768px) {\n    padding: 6px;\n    font-size: 0.9rem;\n    min-width: 32px;\n    height: 32px;\n  }\n  \n  @media (max-width: 480px) {\n    padding: 8px;\n    font-size: 0.85rem;\n    min-width: 36px;\n    height: 36px;\n  }\n  \n  &:hover, &:focus {\n    background: ",";\n    outline: none;\n    transform: translateY(-1px);\n  }\n  \n  &:disabled {\n    opacity: 0.6;\n    cursor: not-allowed;\n    transform: none;\n  }\n"])),n=>{let{theme:e}=n;return e.gradients.primary},n=>{let{theme:e}=n;return e.colors.text.primary},n=>{let{theme:e}=n;return e.gradients.gold}),qn=(0,u.Ay)(Vn)(Yn||(Yn=(0,g.A)(["\n  width: 100%;\n  background: linear-gradient(135deg, rgba(231, 76, 60, 0.8) 0%, rgba(192, 57, 43, 0.8) 100%);\n  border: 2px solid rgba(231, 76, 60, 0.3);\n  color: #fff;\n  font-weight: 700;\n  margin-top: 16px;\n  \n  &:hover {\n    background: linear-gradient(135deg, rgba(231, 76, 60, 1) 0%, rgba(192, 57, 43, 1) 100%);\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(231, 76, 60, 0.3);\n  }\n"]))),Kn=u.Ay.div(_n||(_n=(0,g.A)(["\n  margin-bottom: 16px;\n  color: #fff;\n  font-size: 0.9rem;\n  padding: 12px;\n  background: rgba(255, 255, 255, 0.05);\n  border-radius: 8px;\n  border: 1px solid rgba(255, 255, 255, 0.1);\n  \n  @media (max-width: 480px) {\n    font-size: 0.85rem;\n    padding: 10px;\n  }\n"]))),$n=n=>{let{themeMode:e="dark",onToggleTheme:r=()=>{},gradientKey:t="monarch",onGradientChange:o=()=>{}}=n;const{user:a,signOut:i,profile:s,refreshProfile:d,avatarUrl:l}=(0,b.A)(),[c,p]=(0,x.useState)("account"),[g,u]=(0,x.useState)(""),[m,w]=(0,x.useState)(""),[A,k]=(0,x.useState)(!1),[F,j]=(0,x.useState)(!0),[C,z]=(0,x.useState)(null);(0,x.useEffect)(()=>{if(a){var n,e;const r=(null===(n=a.user_metadata)||void 0===n?void 0:n.username)||(null===(e=a.email)||void 0===e?void 0:e.split("@")[0])||"User";u(r),w(r),z(l),E()}},[a,s,l]);const E=async()=>{if(a&&!s)try{var n,e;console.log("Ensuring profile exists for user:",a.id);const{error:r}=await y.N.from("user_profiles").upsert({id:a.id,display_name:(null===(n=a.user_metadata)||void 0===n?void 0:n.username)||(null===(e=a.email)||void 0===e?void 0:e.split("@")[0])||"User",email:a.email,created_at:(new Date).toISOString(),updated_at:(new Date).toISOString()});r?console.error("Error creating profile:",r):(console.log("Profile created successfully"),await d())}catch(r){console.error("Error ensuring profile exists:",r)}},S=(0,h.Zp)();return(0,v.jsxs)(Nn,{children:[(0,v.jsx)(Rn,{children:"Account & Profile"}),(0,v.jsxs)(Mn,{children:[(0,v.jsxs)(Gn,{children:[(0,v.jsxs)(Jn,{"aria-expanded":"account"===c,onClick:()=>p("account"===c?"":"account"),children:["Account & Profile",(0,v.jsx)("span",{children:"account"===c?"\u25b2":"\u25bc"})]}),"account"===c&&(0,v.jsxs)(Ln,{children:[(0,v.jsxs)(Wn,{style:{flexDirection:"column",alignItems:"center",textAlign:"center"},children:[(0,v.jsx)(Zn,{style:{marginBottom:"12px"},children:"Profile Picture"}),(0,v.jsx)(I,{userId:null===a||void 0===a?void 0:a.id,currentAvatarUrl:l,onAvatarUpdate:async n=>{console.log("\ud83d\udd04 Avatar updated, syncing state...",n),z(n);try{await d(),console.log("\u2705 Profile refreshed successfully")}catch(e){console.error("\u274c Failed to refresh profile:",e)}setTimeout(()=>{console.log("\ud83d\udd04 State sync complete")},500)},size:80,showButton:!0})]}),(0,v.jsxs)(Wn,{children:[(0,v.jsx)(Zn,{htmlFor:"displayName",children:"Display Name"}),(0,v.jsxs)("div",{style:{display:"flex",gap:"8px",alignItems:"center",width:"100%"},children:[(0,v.jsx)(Hn,{id:"displayName",value:g,onChange:n=>u(n.target.value),onKeyDown:n=>{var e;"Enter"===n.key&&A&&g!==m?(n.preventDefault(),null===(e=n.target.nextSibling)||void 0===e||e.click()):"Escape"===n.key&&A&&(n.preventDefault(),u(m),k(!1))},placeholder:"Enter your display name",disabled:!A,style:{borderColor:g!==m?"rgba(255, 215, 0, 0.5)":void 0,boxShadow:g!==m?"0 0 8px rgba(255, 215, 0, 0.2)":void 0,opacity:A?1:.7,cursor:A?"text":"default"}}),(0,v.jsx)(Xn,{type:"button",onClick:async()=>{if(A)if(g!==m)try{const{error:n}=await y.N.from("user_profiles").upsert({id:a.id,display_name:g,updated_at:(new Date).toISOString()});if(n)throw n;const{error:e}=await y.N.auth.updateUser({data:{username:g}});if(e)throw e;w(g),k(!1),alert("Display name updated successfully!")}catch(n){console.error("Error updating display name:",n),alert("Failed to update display name. Please try again.")}else u(m),k(!1);else k(!0)},style:{background:A&&g!==m?"rgba(255, 215, 0, 0.3)":"rgba(255, 215, 0, 0.2)",border:A&&g!==m?"1px solid rgba(255, 215, 0, 0.5)":"1px solid rgba(255, 215, 0, 0.3)",color:A&&g!==m?"#000":"#fff",fontWeight:A&&g!==m?"bold":"normal"},disabled:A&&g===m,title:A?g!==m?"Save":"Cancel":"Edit",children:A?g!==m?"\u2713":"\u2715":"\u270f\ufe0f"})]})]}),(0,v.jsxs)(Wn,{children:[(0,v.jsx)(Zn,{children:"Email"}),(0,v.jsx)("span",{style:{color:"#FFB000",textDecoration:"underline"},children:(null===a||void 0===a?void 0:a.email)||"Not logged in"})]}),(0,v.jsxs)(Wn,{children:[(0,v.jsx)(Zn,{htmlFor:"emailPref",children:"Email Preferences"}),(0,v.jsx)(Qn,{id:"emailPref",checked:F,onChange:n=>j(n.target.checked)})]}),(0,v.jsxs)(Wn,{children:[(0,v.jsx)(Zn,{children:"Password/Security"}),(0,v.jsx)(Vn,{type:"button",children:"Change Password"})]}),a?(0,v.jsxs)("div",{children:[(0,v.jsxs)(Kn,{children:[(0,v.jsx)("strong",{children:"Logged in as:"})," ",a.email]}),(0,v.jsx)(An,{children:(0,v.jsx)(ln,{})}),(0,v.jsx)(qn,{onClick:async()=>{try{console.log("\ud83d\udd04 Sign out button clicked!"),console.log("User before sign out:",a),console.log("Sign out function:",i);const n=new Promise((n,e)=>{setTimeout(()=>e(new Error("Sign out timeout - network issue")),5e3)});if(i){console.log("Using useAuth signOut with timeout...");const e=await Promise.race([i(),n]);console.log("Sign out result:",e),await(0,f.eC)(),console.log("Sign out successful, navigating to home..."),S("/")}else{console.log("useAuth signOut not available, trying direct Supabase...");const{error:e}=await Promise.race([y.N.auth.signOut(),n]);if(e)throw e;await(0,f.eC)(),console.log("Sign out successful, navigating to home..."),S("/")}}catch(n){if(console.error("\u274c Error signing out:",n),n.message.includes("timeout"))return console.log("Network timeout detected, forcing comprehensive cleanup..."),void(0,f.W1)();console.log("Sign out failed, attempting comprehensive cleanup...");try{await(0,f.eC)(),(0,f.un)()}catch(e){console.error("Cleanup failed, using emergency cleanup:",e),(0,f.W1)()}}},children:"Sign Out"})]}):(0,v.jsx)(Vn,{style:{marginTop:12,width:"100%"},onClick:()=>{S("/login")},children:"Sign In"})]})]}),(0,v.jsxs)(Gn,{children:[(0,v.jsxs)(Jn,{"aria-expanded":"theme"===c,onClick:()=>p("theme"===c?"":"theme"),children:["App Experience",(0,v.jsx)("span",{children:"theme"===c?"\u25b2":"\u25bc"})]}),"theme"===c&&(0,v.jsx)(Ln,{children:(0,v.jsxs)(Wn,{children:[(0,v.jsx)(Zn,{children:"Dark Mode"}),(0,v.jsx)(Qn,{type:"checkbox",checked:"dark"===e,onChange:r})]})})]}),(0,v.jsx)(On,{onClick:()=>S("/profile"),children:"\u2190 Back to Profile"})]})]})}}}]);
//# sourceMappingURL=253.0b67d0fe.chunk.js.map